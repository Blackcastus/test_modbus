ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"user_mb_app.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.eMBRegInputCB,"ax",%progbits
  18              		.align	1
  19              		.global	eMBRegInputCB
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	eMBRegInputCB:
  25              	.LVL0:
  26              	.LFB65:
  27              		.file 1 "FreeModbus/app/user_mb_app.c"
   1:FreeModbus/app/user_mb_app.c **** #include "user_mb_app.h"
   2:FreeModbus/app/user_mb_app.c **** 
   3:FreeModbus/app/user_mb_app.c **** #if (MB_SLAVE_ASCII_ENABLED > 0 || MB_SLAVE_RTU_ENABLED > 0 || MB_SLAVE_TCP_ENABLED > 0)
   4:FreeModbus/app/user_mb_app.c **** 
   5:FreeModbus/app/user_mb_app.c **** /*------------------------Slave mode use these variables----------------------*/
   6:FreeModbus/app/user_mb_app.c **** 
   7:FreeModbus/app/user_mb_app.c **** //Slave mode:DiscreteInputs variables
   8:FreeModbus/app/user_mb_app.c **** #if S_DISCRETE_INPUT_NDISCRETES > 0
   9:FreeModbus/app/user_mb_app.c **** USHORT   usSDiscInStart                               = S_DISCRETE_INPUT_START;
  10:FreeModbus/app/user_mb_app.c **** #if S_DISCRETE_INPUT_NDISCRETES%8
  11:FreeModbus/app/user_mb_app.c **** UCHAR    ucSDiscInBuf[S_DISCRETE_INPUT_NDISCRETES/8+1];
  12:FreeModbus/app/user_mb_app.c **** #else
  13:FreeModbus/app/user_mb_app.c **** UCHAR    ucSDiscInBuf[S_DISCRETE_INPUT_NDISCRETES/8]  ;
  14:FreeModbus/app/user_mb_app.c **** #endif
  15:FreeModbus/app/user_mb_app.c **** #endif
  16:FreeModbus/app/user_mb_app.c **** 
  17:FreeModbus/app/user_mb_app.c **** //Slave mode:Coils variables
  18:FreeModbus/app/user_mb_app.c **** #if S_COIL_NCOILS > 0
  19:FreeModbus/app/user_mb_app.c **** USHORT   usSCoilStart                                 = S_COIL_START;
  20:FreeModbus/app/user_mb_app.c **** #if S_COIL_NCOILS%8
  21:FreeModbus/app/user_mb_app.c **** UCHAR    ucSCoilBuf[S_COIL_NCOILS/8+1]                ;
  22:FreeModbus/app/user_mb_app.c **** #else
  23:FreeModbus/app/user_mb_app.c **** UCHAR    ucSCoilBuf[S_COIL_NCOILS/8]                  ;
  24:FreeModbus/app/user_mb_app.c **** #endif
  25:FreeModbus/app/user_mb_app.c **** #endif
  26:FreeModbus/app/user_mb_app.c **** 
  27:FreeModbus/app/user_mb_app.c **** //Slave mode:InputRegister variables
  28:FreeModbus/app/user_mb_app.c **** #if S_REG_INPUT_NREGS > 0
  29:FreeModbus/app/user_mb_app.c **** USHORT   usSRegInStart                                = S_REG_INPUT_START;
  30:FreeModbus/app/user_mb_app.c **** USHORT   usSRegInBuf[S_REG_INPUT_NREGS]               ;
  31:FreeModbus/app/user_mb_app.c **** #endif
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 2


  32:FreeModbus/app/user_mb_app.c **** 
  33:FreeModbus/app/user_mb_app.c **** //Slave mode:HoldingRegister variables Funstion 03/06
  34:FreeModbus/app/user_mb_app.c **** #if S_REG_HOLDING_NREGS > 0
  35:FreeModbus/app/user_mb_app.c **** USHORT   usSRegHoldStart                              = S_REG_HOLDING_START;
  36:FreeModbus/app/user_mb_app.c **** USHORT   usSRegHoldBuf[S_REG_HOLDING_NREGS]           ;
  37:FreeModbus/app/user_mb_app.c **** #endif
  38:FreeModbus/app/user_mb_app.c **** /*------------------------Slave user code----------------------*/
  39:FreeModbus/app/user_mb_app.c **** extern uint16_t adc_data[2];
  40:FreeModbus/app/user_mb_app.c **** /*------------------------Slave registers callback function----------------------*/
  41:FreeModbus/app/user_mb_app.c **** 
  42:FreeModbus/app/user_mb_app.c **** /**
  43:FreeModbus/app/user_mb_app.c ****  * Modbus slave input register callback function.
  44:FreeModbus/app/user_mb_app.c ****  *
  45:FreeModbus/app/user_mb_app.c ****  * @param pucRegBuffer input register buffer
  46:FreeModbus/app/user_mb_app.c ****  * @param usAddress input register address
  47:FreeModbus/app/user_mb_app.c ****  * @param usNRegs input register number
  48:FreeModbus/app/user_mb_app.c ****  *
  49:FreeModbus/app/user_mb_app.c ****  * @return result
  50:FreeModbus/app/user_mb_app.c ****  */
  51:FreeModbus/app/user_mb_app.c **** eMBErrorCode eMBRegInputCB(UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNRegs )
  52:FreeModbus/app/user_mb_app.c **** {
  28              		.loc 1 52 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              		.loc 1 52 1 is_stmt 0 view .LVU1
  34 0000 10B4     		push	{r4}
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 4
  37              		.cfi_offset 4, -4
  53:FreeModbus/app/user_mb_app.c **** #if S_REG_INPUT_NREGS > 0
  54:FreeModbus/app/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
  38              		.loc 1 54 5 is_stmt 1 view .LVU2
  39              	.LVL1:
  55:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
  40              		.loc 1 55 5 view .LVU3
  56:FreeModbus/app/user_mb_app.c ****     USHORT *        pusRegInputBuf;
  41              		.loc 1 56 5 view .LVU4
  57:FreeModbus/app/user_mb_app.c ****     USHORT          REG_INPUT_START;
  42              		.loc 1 57 5 view .LVU5
  58:FreeModbus/app/user_mb_app.c ****     USHORT          REG_INPUT_NREGS;
  43              		.loc 1 58 5 view .LVU6
  59:FreeModbus/app/user_mb_app.c ****     USHORT          usRegInStart;
  44              		.loc 1 59 5 view .LVU7
  60:FreeModbus/app/user_mb_app.c ****     
  61:FreeModbus/app/user_mb_app.c ****     pusRegInputBuf = usSRegInBuf;
  45              		.loc 1 61 5 view .LVU8
  62:FreeModbus/app/user_mb_app.c ****     REG_INPUT_START = S_REG_INPUT_START;
  46              		.loc 1 62 5 view .LVU9
  63:FreeModbus/app/user_mb_app.c ****     REG_INPUT_NREGS = S_REG_INPUT_NREGS;
  47              		.loc 1 63 5 view .LVU10
  64:FreeModbus/app/user_mb_app.c ****     usRegInStart = usSRegInStart;
  48              		.loc 1 64 5 view .LVU11
  49              		.loc 1 64 18 is_stmt 0 view .LVU12
  50 0002 104B     		ldr	r3, .L7
  51 0004 1C88     		ldrh	r4, [r3]
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 3


  52              	.LVL2:
  65:FreeModbus/app/user_mb_app.c **** 
  66:FreeModbus/app/user_mb_app.c ****     /* it already plus one in modbus function method. */
  67:FreeModbus/app/user_mb_app.c ****     usAddress--;
  53              		.loc 1 67 5 is_stmt 1 view .LVU13
  54              		.loc 1 67 14 is_stmt 0 view .LVU14
  55 0006 4B1E     		subs	r3, r1, #1
  56 0008 9BB2     		uxth	r3, r3
  57              	.LVL3:
  68:FreeModbus/app/user_mb_app.c **** 
  69:FreeModbus/app/user_mb_app.c ****     if ((usAddress >= REG_INPUT_START) && (usAddress + usNRegs <= REG_INPUT_START + REG_INPUT_NREGS
  58              		.loc 1 69 5 is_stmt 1 view .LVU15
  59              		.loc 1 69 54 is_stmt 0 view .LVU16
  60 000a 9918     		adds	r1, r3, r2
  61              		.loc 1 69 40 view .LVU17
  62 000c 6429     		cmp	r1, #100
  63 000e 17DC     		bgt	.L5
  70:FreeModbus/app/user_mb_app.c ****     {
  71:FreeModbus/app/user_mb_app.c ****         iRegIndex = usAddress - usRegInStart;
  64              		.loc 1 71 9 is_stmt 1 view .LVU18
  65              		.loc 1 71 19 is_stmt 0 view .LVU19
  66 0010 1B1B     		subs	r3, r3, r4
  67              	.LVL4:
  68              		.loc 1 71 19 view .LVU20
  69 0012 9BB2     		uxth	r3, r3
  70              	.LVL5:
  72:FreeModbus/app/user_mb_app.c ****         while (usNRegs > 0)
  71              		.loc 1 72 9 is_stmt 1 view .LVU21
  72              		.loc 1 72 15 is_stmt 0 view .LVU22
  73 0014 0FE0     		b	.L3
  74              	.LVL6:
  75              	.L4:
  73:FreeModbus/app/user_mb_app.c ****         {
  74:FreeModbus/app/user_mb_app.c ****             *pucRegBuffer++ = (UCHAR) (pusRegInputBuf[iRegIndex] >> 8);
  76              		.loc 1 74 13 is_stmt 1 view .LVU23
  77              		.loc 1 74 54 is_stmt 0 view .LVU24
  78 0016 0C4C     		ldr	r4, .L7+4
  79 0018 34F813C0 		ldrh	ip, [r4, r3, lsl #1]
  80              	.LVL7:
  81              		.loc 1 74 31 view .LVU25
  82 001c 4FEA1C2C 		lsr	ip, ip, #8
  83              		.loc 1 74 29 view .LVU26
  84 0020 0146     		mov	r1, r0
  85 0022 01F802CB 		strb	ip, [r1], #2
  75:FreeModbus/app/user_mb_app.c ****             *pucRegBuffer++ = (UCHAR) (pusRegInputBuf[iRegIndex] & 0xFF);
  86              		.loc 1 75 13 is_stmt 1 view .LVU27
  87              	.LVL8:
  88              		.loc 1 75 31 is_stmt 0 view .LVU28
  89 0026 14F81340 		ldrb	r4, [r4, r3, lsl #1]	@ zero_extendqisi2
  90              		.loc 1 75 29 view .LVU29
  91 002a 4470     		strb	r4, [r0, #1]
  76:FreeModbus/app/user_mb_app.c ****             iRegIndex++;
  92              		.loc 1 76 13 is_stmt 1 view .LVU30
  93              		.loc 1 76 22 is_stmt 0 view .LVU31
  94 002c 0133     		adds	r3, r3, #1
  95              	.LVL9:
  96              		.loc 1 76 22 view .LVU32
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 4


  97 002e 9BB2     		uxth	r3, r3
  98              	.LVL10:
  77:FreeModbus/app/user_mb_app.c ****             usNRegs--;
  99              		.loc 1 77 13 is_stmt 1 view .LVU33
 100              		.loc 1 77 20 is_stmt 0 view .LVU34
 101 0030 013A     		subs	r2, r2, #1
 102              	.LVL11:
 103              		.loc 1 77 20 view .LVU35
 104 0032 92B2     		uxth	r2, r2
 105              	.LVL12:
  75:FreeModbus/app/user_mb_app.c ****             *pucRegBuffer++ = (UCHAR) (pusRegInputBuf[iRegIndex] & 0xFF);
 106              		.loc 1 75 26 view .LVU36
 107 0034 0846     		mov	r0, r1
 108              	.LVL13:
 109              	.L3:
  72:FreeModbus/app/user_mb_app.c ****         {
 110              		.loc 1 72 15 is_stmt 1 view .LVU37
 111 0036 002A     		cmp	r2, #0
 112 0038 EDD1     		bne	.L4
  54:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
 113              		.loc 1 54 21 is_stmt 0 view .LVU38
 114 003a 0020     		movs	r0, #0
 115              	.LVL14:
 116              	.L2:
  78:FreeModbus/app/user_mb_app.c ****         }
  79:FreeModbus/app/user_mb_app.c ****     }
  80:FreeModbus/app/user_mb_app.c ****     else
  81:FreeModbus/app/user_mb_app.c ****     {
  82:FreeModbus/app/user_mb_app.c ****         eStatus = MB_ENOREG;
  83:FreeModbus/app/user_mb_app.c ****     }
  84:FreeModbus/app/user_mb_app.c **** 
  85:FreeModbus/app/user_mb_app.c ****     return eStatus;
 117              		.loc 1 85 5 is_stmt 1 view .LVU39
  86:FreeModbus/app/user_mb_app.c **** #else
  87:FreeModbus/app/user_mb_app.c **** 	return MB_ENOREG;
  88:FreeModbus/app/user_mb_app.c **** #endif
  89:FreeModbus/app/user_mb_app.c **** }
 118              		.loc 1 89 1 is_stmt 0 view .LVU40
 119 003c 10BC     		pop	{r4}
 120              	.LCFI1:
 121              		.cfi_remember_state
 122              		.cfi_restore 4
 123              		.cfi_def_cfa_offset 0
 124 003e 7047     		bx	lr
 125              	.LVL15:
 126              	.L5:
 127              	.LCFI2:
 128              		.cfi_restore_state
  82:FreeModbus/app/user_mb_app.c ****     }
 129              		.loc 1 82 17 view .LVU41
 130 0040 0120     		movs	r0, #1
 131              	.LVL16:
  82:FreeModbus/app/user_mb_app.c ****     }
 132              		.loc 1 82 17 view .LVU42
 133 0042 FBE7     		b	.L2
 134              	.L8:
 135              		.align	2
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 5


 136              	.L7:
 137 0044 00000000 		.word	.LANCHOR0
 138 0048 00000000 		.word	.LANCHOR1
 139              		.cfi_endproc
 140              	.LFE65:
 142              		.section	.text.eMBRegHoldingCB,"ax",%progbits
 143              		.align	1
 144              		.global	eMBRegHoldingCB
 145              		.syntax unified
 146              		.thumb
 147              		.thumb_func
 149              	eMBRegHoldingCB:
 150              	.LVL17:
 151              	.LFB66:
  90:FreeModbus/app/user_mb_app.c **** 
  91:FreeModbus/app/user_mb_app.c **** /**
  92:FreeModbus/app/user_mb_app.c ****  * Modbus slave holding register callback function.
  93:FreeModbus/app/user_mb_app.c ****  *
  94:FreeModbus/app/user_mb_app.c ****  * @param pucRegBuffer holding register buffer
  95:FreeModbus/app/user_mb_app.c ****  * @param usAddress holding register address
  96:FreeModbus/app/user_mb_app.c ****  * @param usNRegs holding register number
  97:FreeModbus/app/user_mb_app.c ****  * @param eMode read or write
  98:FreeModbus/app/user_mb_app.c ****  *
  99:FreeModbus/app/user_mb_app.c ****  * @return result
 100:FreeModbus/app/user_mb_app.c ****  */
 101:FreeModbus/app/user_mb_app.c **** eMBErrorCode eMBRegHoldingCB(UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNRegs, eMBRegisterMod
 102:FreeModbus/app/user_mb_app.c **** {
 152              		.loc 1 102 1 is_stmt 1 view -0
 153              		.cfi_startproc
 154              		@ args = 0, pretend = 0, frame = 0
 155              		@ frame_needed = 0, uses_anonymous_args = 0
 156              		.loc 1 102 1 is_stmt 0 view .LVU44
 157 0000 10B5     		push	{r4, lr}
 158              	.LCFI3:
 159              		.cfi_def_cfa_offset 8
 160              		.cfi_offset 4, -8
 161              		.cfi_offset 14, -4
 103:FreeModbus/app/user_mb_app.c **** #if S_REG_HOLDING_NREGS > 0
 104:FreeModbus/app/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
 162              		.loc 1 104 5 is_stmt 1 view .LVU45
 163              	.LVL18:
 105:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
 164              		.loc 1 105 5 view .LVU46
 106:FreeModbus/app/user_mb_app.c ****     USHORT *        pusRegHoldingBuf;
 165              		.loc 1 106 5 view .LVU47
 107:FreeModbus/app/user_mb_app.c ****     USHORT          REG_HOLDING_START;
 166              		.loc 1 107 5 view .LVU48
 108:FreeModbus/app/user_mb_app.c ****     USHORT          REG_HOLDING_NREGS;
 167              		.loc 1 108 5 view .LVU49
 109:FreeModbus/app/user_mb_app.c ****     USHORT          usRegHoldStart;
 168              		.loc 1 109 5 view .LVU50
 110:FreeModbus/app/user_mb_app.c ****     pusRegHoldingBuf = usSRegHoldBuf;
 169              		.loc 1 110 5 view .LVU51
 111:FreeModbus/app/user_mb_app.c ****     REG_HOLDING_START = S_REG_HOLDING_START;
 170              		.loc 1 111 5 view .LVU52
 112:FreeModbus/app/user_mb_app.c ****     REG_HOLDING_NREGS = S_REG_HOLDING_NREGS;
 171              		.loc 1 112 5 view .LVU53
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 6


 113:FreeModbus/app/user_mb_app.c ****     usRegHoldStart = usSRegHoldStart;
 172              		.loc 1 113 5 view .LVU54
 173              		.loc 1 113 20 is_stmt 0 view .LVU55
 174 0002 1D4C     		ldr	r4, .L17
 175 0004 B4F800C0 		ldrh	ip, [r4]
 176              	.LVL19:
 114:FreeModbus/app/user_mb_app.c **** 
 115:FreeModbus/app/user_mb_app.c ****     /* it already plus one in modbus function method. */
 116:FreeModbus/app/user_mb_app.c ****     usAddress--;
 177              		.loc 1 116 5 is_stmt 1 view .LVU56
 178              		.loc 1 116 14 is_stmt 0 view .LVU57
 179 0008 0139     		subs	r1, r1, #1
 180              	.LVL20:
 181              		.loc 1 116 14 view .LVU58
 182 000a 89B2     		uxth	r1, r1
 183              	.LVL21:
 117:FreeModbus/app/user_mb_app.c **** 
 118:FreeModbus/app/user_mb_app.c ****     if ((usAddress >= REG_HOLDING_START) && (usAddress + usNRegs <= REG_HOLDING_START + REG_HOLDING
 184              		.loc 1 118 5 is_stmt 1 view .LVU59
 185              		.loc 1 118 56 is_stmt 0 view .LVU60
 186 000c 8C18     		adds	r4, r1, r2
 187              		.loc 1 118 42 view .LVU61
 188 000e 642C     		cmp	r4, #100
 189 0010 2FDC     		bgt	.L15
 119:FreeModbus/app/user_mb_app.c ****     {
 120:FreeModbus/app/user_mb_app.c ****         iRegIndex = usAddress - usRegHoldStart;
 190              		.loc 1 120 9 is_stmt 1 view .LVU62
 191              		.loc 1 120 19 is_stmt 0 view .LVU63
 192 0012 A1EB0C01 		sub	r1, r1, ip
 193              	.LVL22:
 194              		.loc 1 120 19 view .LVU64
 195 0016 89B2     		uxth	r1, r1
 196              	.LVL23:
 121:FreeModbus/app/user_mb_app.c ****         switch (eMode)
 197              		.loc 1 121 9 is_stmt 1 view .LVU65
 198 0018 9BB1     		cbz	r3, .L11
 199 001a 012B     		cmp	r3, #1
 200 001c 25D0     		beq	.L12
 201 001e 0020     		movs	r0, #0
 202              	.LVL24:
 203              		.loc 1 121 9 is_stmt 0 view .LVU66
 204 0020 28E0     		b	.L10
 205              	.LVL25:
 206              	.L13:
 122:FreeModbus/app/user_mb_app.c ****         {
 123:FreeModbus/app/user_mb_app.c ****         /* read current register values from the protocol stack. */
 124:FreeModbus/app/user_mb_app.c ****         case MB_REG_READ:
 125:FreeModbus/app/user_mb_app.c ****             while (usNRegs > 0)
 126:FreeModbus/app/user_mb_app.c ****             {
 127:FreeModbus/app/user_mb_app.c ****                 *pucRegBuffer++ = (UCHAR) (pusRegHoldingBuf[iRegIndex] >> 8);
 207              		.loc 1 127 17 is_stmt 1 view .LVU67
 208              		.loc 1 127 60 is_stmt 0 view .LVU68
 209 0022 164C     		ldr	r4, .L17+4
 210 0024 34F811E0 		ldrh	lr, [r4, r1, lsl #1]
 211              	.LVL26:
 212              		.loc 1 127 35 view .LVU69
 213 0028 4FEA1E2E 		lsr	lr, lr, #8
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 7


 214              		.loc 1 127 33 view .LVU70
 215 002c 8446     		mov	ip, r0
 216 002e 0CF802EB 		strb	lr, [ip], #2
 128:FreeModbus/app/user_mb_app.c ****                 *pucRegBuffer++ = (UCHAR) (pusRegHoldingBuf[iRegIndex] & 0xFF);
 217              		.loc 1 128 17 is_stmt 1 view .LVU71
 218              	.LVL27:
 219              		.loc 1 128 35 is_stmt 0 view .LVU72
 220 0032 14F81140 		ldrb	r4, [r4, r1, lsl #1]	@ zero_extendqisi2
 221              		.loc 1 128 33 view .LVU73
 222 0036 4470     		strb	r4, [r0, #1]
 129:FreeModbus/app/user_mb_app.c ****                 iRegIndex++;
 223              		.loc 1 129 17 is_stmt 1 view .LVU74
 224              		.loc 1 129 26 is_stmt 0 view .LVU75
 225 0038 0131     		adds	r1, r1, #1
 226              	.LVL28:
 227              		.loc 1 129 26 view .LVU76
 228 003a 89B2     		uxth	r1, r1
 229              	.LVL29:
 130:FreeModbus/app/user_mb_app.c ****                 usNRegs--;
 230              		.loc 1 130 17 is_stmt 1 view .LVU77
 231              		.loc 1 130 24 is_stmt 0 view .LVU78
 232 003c 013A     		subs	r2, r2, #1
 233              	.LVL30:
 234              		.loc 1 130 24 view .LVU79
 235 003e 92B2     		uxth	r2, r2
 236              	.LVL31:
 128:FreeModbus/app/user_mb_app.c ****                 *pucRegBuffer++ = (UCHAR) (pusRegHoldingBuf[iRegIndex] & 0xFF);
 237              		.loc 1 128 30 view .LVU80
 238 0040 6046     		mov	r0, ip
 239              	.LVL32:
 240              	.L11:
 125:FreeModbus/app/user_mb_app.c ****             {
 241              		.loc 1 125 19 is_stmt 1 view .LVU81
 242 0042 002A     		cmp	r2, #0
 243 0044 EDD1     		bne	.L13
 104:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
 244              		.loc 1 104 21 is_stmt 0 view .LVU82
 245 0046 1846     		mov	r0, r3
 246              	.LVL33:
 104:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
 247              		.loc 1 104 21 view .LVU83
 248 0048 14E0     		b	.L10
 249              	.LVL34:
 250              	.L14:
 131:FreeModbus/app/user_mb_app.c ****             }
 132:FreeModbus/app/user_mb_app.c ****             break;
 133:FreeModbus/app/user_mb_app.c **** 
 134:FreeModbus/app/user_mb_app.c ****         /* write current register values with new values from the protocol stack. */
 135:FreeModbus/app/user_mb_app.c ****         case MB_REG_WRITE:
 136:FreeModbus/app/user_mb_app.c ****             while (usNRegs > 0)
 137:FreeModbus/app/user_mb_app.c ****             {
 138:FreeModbus/app/user_mb_app.c ****                 pusRegHoldingBuf[iRegIndex] = *pucRegBuffer++ << 8;
 251              		.loc 1 138 17 is_stmt 1 view .LVU84
 252              		.loc 1 138 47 is_stmt 0 view .LVU85
 253 004a 8446     		mov	ip, r0
 254 004c 1CF8023B 		ldrb	r3, [ip], #2	@ zero_extendqisi2
 255              		.loc 1 138 33 view .LVU86
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 8


 256 0050 0A4C     		ldr	r4, .L17+4
 257              		.loc 1 138 63 view .LVU87
 258 0052 1B02     		lsls	r3, r3, #8
 259              		.loc 1 138 45 view .LVU88
 260 0054 24F81130 		strh	r3, [r4, r1, lsl #1]	@ movhi
 139:FreeModbus/app/user_mb_app.c ****                 pusRegHoldingBuf[iRegIndex] |= *pucRegBuffer++;
 261              		.loc 1 139 17 is_stmt 1 view .LVU89
 262              	.LVL35:
 263              		.loc 1 139 48 is_stmt 0 view .LVU90
 264 0058 4078     		ldrb	r0, [r0, #1]	@ zero_extendqisi2
 265              		.loc 1 139 45 view .LVU91
 266 005a 0343     		orrs	r3, r3, r0
 267 005c 24F81130 		strh	r3, [r4, r1, lsl #1]	@ movhi
 140:FreeModbus/app/user_mb_app.c ****                 iRegIndex++;
 268              		.loc 1 140 17 is_stmt 1 view .LVU92
 269              		.loc 1 140 26 is_stmt 0 view .LVU93
 270 0060 0131     		adds	r1, r1, #1
 271              	.LVL36:
 272              		.loc 1 140 26 view .LVU94
 273 0062 89B2     		uxth	r1, r1
 274              	.LVL37:
 141:FreeModbus/app/user_mb_app.c ****                 usNRegs--;
 275              		.loc 1 141 17 is_stmt 1 view .LVU95
 276              		.loc 1 141 24 is_stmt 0 view .LVU96
 277 0064 013A     		subs	r2, r2, #1
 278              	.LVL38:
 279              		.loc 1 141 24 view .LVU97
 280 0066 92B2     		uxth	r2, r2
 281              	.LVL39:
 139:FreeModbus/app/user_mb_app.c ****                 pusRegHoldingBuf[iRegIndex] |= *pucRegBuffer++;
 282              		.loc 1 139 61 view .LVU98
 283 0068 6046     		mov	r0, ip
 284              	.LVL40:
 285              	.L12:
 136:FreeModbus/app/user_mb_app.c ****             {
 286              		.loc 1 136 19 is_stmt 1 view .LVU99
 287 006a 002A     		cmp	r2, #0
 288 006c EDD1     		bne	.L14
 104:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
 289              		.loc 1 104 21 is_stmt 0 view .LVU100
 290 006e 0020     		movs	r0, #0
 291              	.LVL41:
 104:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex;
 292              		.loc 1 104 21 view .LVU101
 293 0070 00E0     		b	.L10
 294              	.LVL42:
 295              	.L15:
 142:FreeModbus/app/user_mb_app.c ****             }
 143:FreeModbus/app/user_mb_app.c ****             break;
 144:FreeModbus/app/user_mb_app.c ****         }
 145:FreeModbus/app/user_mb_app.c ****     }
 146:FreeModbus/app/user_mb_app.c ****     else
 147:FreeModbus/app/user_mb_app.c ****     {
 148:FreeModbus/app/user_mb_app.c ****         eStatus = MB_ENOREG;
 296              		.loc 1 148 17 view .LVU102
 297 0072 0120     		movs	r0, #1
 298              	.LVL43:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 9


 299              	.L10:
 149:FreeModbus/app/user_mb_app.c ****     }
 150:FreeModbus/app/user_mb_app.c ****     return eStatus;
 300              		.loc 1 150 5 is_stmt 1 view .LVU103
 151:FreeModbus/app/user_mb_app.c **** #else
 152:FreeModbus/app/user_mb_app.c **** 	return MB_ENOREG;
 153:FreeModbus/app/user_mb_app.c **** #endif
 154:FreeModbus/app/user_mb_app.c **** }
 301              		.loc 1 154 1 is_stmt 0 view .LVU104
 302 0074 10BD     		pop	{r4, pc}
 303              	.L18:
 304 0076 00BF     		.align	2
 305              	.L17:
 306 0078 00000000 		.word	.LANCHOR2
 307 007c 00000000 		.word	.LANCHOR3
 308              		.cfi_endproc
 309              	.LFE66:
 311              		.section	.rodata.eMBRegCoilsCB.str1.4,"aMS",%progbits,1
 312              		.align	2
 313              	.LC0:
 314 0000 52656164 		.ascii	"ReadCoilsCBs\000"
 314      436F696C 
 314      73434273 
 314      00
 315              		.section	.text.eMBRegCoilsCB,"ax",%progbits
 316              		.align	1
 317              		.global	eMBRegCoilsCB
 318              		.syntax unified
 319              		.thumb
 320              		.thumb_func
 322              	eMBRegCoilsCB:
 323              	.LVL44:
 324              	.LFB67:
 155:FreeModbus/app/user_mb_app.c **** 
 156:FreeModbus/app/user_mb_app.c **** /**
 157:FreeModbus/app/user_mb_app.c ****  * Modbus slave coils callback function.
 158:FreeModbus/app/user_mb_app.c ****  *
 159:FreeModbus/app/user_mb_app.c ****  * @param pucRegBuffer coils buffer
 160:FreeModbus/app/user_mb_app.c ****  * @param usAddress coils address
 161:FreeModbus/app/user_mb_app.c ****  * @param usNCoils coils number
 162:FreeModbus/app/user_mb_app.c ****  * @param eMode read or write
 163:FreeModbus/app/user_mb_app.c ****  *
 164:FreeModbus/app/user_mb_app.c ****  * @return result
 165:FreeModbus/app/user_mb_app.c ****  */
 166:FreeModbus/app/user_mb_app.c **** eMBErrorCode eMBRegCoilsCB(UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNCoils, eMBRegisterMode
 167:FreeModbus/app/user_mb_app.c **** {
 325              		.loc 1 167 1 is_stmt 1 view -0
 326              		.cfi_startproc
 327              		@ args = 0, pretend = 0, frame = 0
 328              		@ frame_needed = 0, uses_anonymous_args = 0
 329              		.loc 1 167 1 is_stmt 0 view .LVU106
 330 0000 2DE9F843 		push	{r3, r4, r5, r6, r7, r8, r9, lr}
 331              	.LCFI4:
 332              		.cfi_def_cfa_offset 32
 333              		.cfi_offset 3, -32
 334              		.cfi_offset 4, -28
 335              		.cfi_offset 5, -24
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 10


 336              		.cfi_offset 6, -20
 337              		.cfi_offset 7, -16
 338              		.cfi_offset 8, -12
 339              		.cfi_offset 9, -8
 340              		.cfi_offset 14, -4
 341 0004 0446     		mov	r4, r0
 342 0006 0E46     		mov	r6, r1
 343 0008 1746     		mov	r7, r2
 344 000a 9846     		mov	r8, r3
 168:FreeModbus/app/user_mb_app.c **** #if S_COIL_NCOILS > 0
 169:FreeModbus/app/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
 345              		.loc 1 169 5 is_stmt 1 view .LVU107
 346              	.LVL45:
 170:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 347              		.loc 1 170 5 view .LVU108
 171:FreeModbus/app/user_mb_app.c ****     UCHAR *         pucCoilBuf;
 348              		.loc 1 171 5 view .LVU109
 172:FreeModbus/app/user_mb_app.c ****     USHORT          COIL_START;
 349              		.loc 1 172 5 view .LVU110
 173:FreeModbus/app/user_mb_app.c ****     USHORT          COIL_NCOILS;
 350              		.loc 1 173 5 view .LVU111
 174:FreeModbus/app/user_mb_app.c ****     USHORT          usCoilStart;
 351              		.loc 1 174 5 view .LVU112
 175:FreeModbus/app/user_mb_app.c ****     iNReg =  usNCoils / 8 + 1;
 352              		.loc 1 175 5 view .LVU113
 353              		.loc 1 175 27 is_stmt 0 view .LVU114
 354 000c D508     		lsrs	r5, r2, #3
 355              	.LVL46:
 176:FreeModbus/app/user_mb_app.c ****     printf("ReadCoilsCBs\n");
 356              		.loc 1 176 5 is_stmt 1 view .LVU115
 357 000e 2D48     		ldr	r0, .L29
 358              	.LVL47:
 359              		.loc 1 176 5 is_stmt 0 view .LVU116
 360 0010 FFF7FEFF 		bl	puts
 361              	.LVL48:
 177:FreeModbus/app/user_mb_app.c ****     pucCoilBuf = ucSCoilBuf;
 362              		.loc 1 177 5 is_stmt 1 view .LVU117
 178:FreeModbus/app/user_mb_app.c ****     COIL_START = S_COIL_START;
 363              		.loc 1 178 5 view .LVU118
 179:FreeModbus/app/user_mb_app.c ****     COIL_NCOILS = S_COIL_NCOILS;
 364              		.loc 1 179 5 view .LVU119
 180:FreeModbus/app/user_mb_app.c ****     usCoilStart = usSCoilStart;
 365              		.loc 1 180 5 view .LVU120
 366              		.loc 1 180 17 is_stmt 0 view .LVU121
 367 0014 2C4B     		ldr	r3, .L29+4
 368 0016 1A88     		ldrh	r2, [r3]
 369              	.LVL49:
 181:FreeModbus/app/user_mb_app.c **** 
 182:FreeModbus/app/user_mb_app.c ****     /* it already plus one in modbus function method. */
 183:FreeModbus/app/user_mb_app.c ****     usAddress--;
 370              		.loc 1 183 5 is_stmt 1 view .LVU122
 371              		.loc 1 183 14 is_stmt 0 view .LVU123
 372 0018 013E     		subs	r6, r6, #1
 373 001a B6B2     		uxth	r6, r6
 374              	.LVL50:
 184:FreeModbus/app/user_mb_app.c **** 
 185:FreeModbus/app/user_mb_app.c ****     if( ( usAddress >= COIL_START ) && ( usAddress + usNCoils <= COIL_START + COIL_NCOILS ) )
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 11


 375              		.loc 1 185 5 is_stmt 1 view .LVU124
 376              		.loc 1 185 52 is_stmt 0 view .LVU125
 377 001c F319     		adds	r3, r6, r7
 378              		.loc 1 185 37 view .LVU126
 379 001e 102B     		cmp	r3, #16
 380 0020 4CDC     		bgt	.L25
 381 0022 0135     		adds	r5, r5, #1
 382              	.LVL51:
 186:FreeModbus/app/user_mb_app.c ****     {
 187:FreeModbus/app/user_mb_app.c ****         iRegIndex = (USHORT) (usAddress - usCoilStart) / 8;
 383              		.loc 1 187 9 is_stmt 1 view .LVU127
 384              		.loc 1 187 21 is_stmt 0 view .LVU128
 385 0024 B61A     		subs	r6, r6, r2
 386              	.LVL52:
 387              		.loc 1 187 19 view .LVU129
 388 0026 C6F3CC00 		ubfx	r0, r6, #3, #13
 389              	.LVL53:
 188:FreeModbus/app/user_mb_app.c ****         iRegBitIndex = (USHORT) (usAddress - usCoilStart) % 8;
 390              		.loc 1 188 9 is_stmt 1 view .LVU130
 391              		.loc 1 188 22 is_stmt 0 view .LVU131
 392 002a 06F00706 		and	r6, r6, #7
 393              	.LVL54:
 189:FreeModbus/app/user_mb_app.c ****         switch ( eMode )
 394              		.loc 1 189 9 is_stmt 1 view .LVU132
 395 002e B8F1000F 		cmp	r8, #0
 396 0032 13D0     		beq	.L21
 397 0034 B8F1010F 		cmp	r8, #1
 398 0038 31D0     		beq	.L22
 399 003a 0020     		movs	r0, #0
 400              	.LVL55:
 401              		.loc 1 189 9 is_stmt 0 view .LVU133
 402 003c 3FE0     		b	.L20
 403              	.LVL56:
 404              	.L23:
 190:FreeModbus/app/user_mb_app.c ****         {
 191:FreeModbus/app/user_mb_app.c ****         /* read current coil values from the protocol stack. */
 192:FreeModbus/app/user_mb_app.c ****         case MB_REG_READ:
 193:FreeModbus/app/user_mb_app.c ****             while (iNReg > 0)
 194:FreeModbus/app/user_mb_app.c ****             {
 195:FreeModbus/app/user_mb_app.c ****                 *pucRegBuffer++ = xMBUtilGetBits(&pucCoilBuf[iRegIndex++],
 405              		.loc 1 195 17 is_stmt 1 view .LVU134
 406              		.loc 1 195 71 is_stmt 0 view .LVU135
 407 003e 00F10109 		add	r9, r0, #1
 408 0042 1FFA89F9 		uxth	r9, r9
 409              	.LVL57:
 410              		.loc 1 195 35 view .LVU136
 411 0046 0822     		movs	r2, #8
 412 0048 3146     		mov	r1, r6
 413 004a 204B     		ldr	r3, .L29+8
 414 004c 1844     		add	r0, r0, r3
 415 004e FFF7FEFF 		bl	xMBUtilGetBits
 416              	.LVL58:
 417              		.loc 1 195 33 view .LVU137
 418 0052 04F8010B 		strb	r0, [r4], #1
 419              	.LVL59:
 196:FreeModbus/app/user_mb_app.c ****                         iRegBitIndex, 8);
 197:FreeModbus/app/user_mb_app.c ****                 iNReg--;
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 12


 420              		.loc 1 197 17 is_stmt 1 view .LVU138
 421              		.loc 1 197 22 is_stmt 0 view .LVU139
 422 0056 013D     		subs	r5, r5, #1
 423              	.LVL60:
 424              		.loc 1 197 22 view .LVU140
 425 0058 ADB2     		uxth	r5, r5
 426              	.LVL61:
 195:FreeModbus/app/user_mb_app.c ****                         iRegBitIndex, 8);
 427              		.loc 1 195 71 view .LVU141
 428 005a 4846     		mov	r0, r9
 429              	.LVL62:
 430              	.L21:
 193:FreeModbus/app/user_mb_app.c ****             {
 431              		.loc 1 193 19 is_stmt 1 view .LVU142
 432 005c 002D     		cmp	r5, #0
 433 005e EED1     		bne	.L23
 198:FreeModbus/app/user_mb_app.c ****             }
 199:FreeModbus/app/user_mb_app.c ****             pucRegBuffer--;
 434              		.loc 1 199 13 view .LVU143
 435              	.LVL63:
 200:FreeModbus/app/user_mb_app.c ****             /* last coils */
 201:FreeModbus/app/user_mb_app.c ****             usNCoils = usNCoils % 8;
 436              		.loc 1 201 13 view .LVU144
 437              		.loc 1 201 22 is_stmt 0 view .LVU145
 438 0060 07F00707 		and	r7, r7, #7
 439              	.LVL64:
 202:FreeModbus/app/user_mb_app.c ****             /* filling zero to high bit */
 203:FreeModbus/app/user_mb_app.c ****             *pucRegBuffer = *pucRegBuffer << (8 - usNCoils);
 440              		.loc 1 203 13 is_stmt 1 view .LVU146
 441              		.loc 1 203 29 is_stmt 0 view .LVU147
 442 0064 14F8013C 		ldrb	r3, [r4, #-1]	@ zero_extendqisi2
 443              		.loc 1 203 49 view .LVU148
 444 0068 C7F10807 		rsb	r7, r7, #8
 445              	.LVL65:
 446              		.loc 1 203 43 view .LVU149
 447 006c BB40     		lsls	r3, r3, r7
 448              		.loc 1 203 27 view .LVU150
 449 006e DBB2     		uxtb	r3, r3
 450 0070 04F8013C 		strb	r3, [r4, #-1]
 204:FreeModbus/app/user_mb_app.c ****             *pucRegBuffer = *pucRegBuffer >> (8 - usNCoils);
 451              		.loc 1 204 13 is_stmt 1 view .LVU151
 452              		.loc 1 204 43 is_stmt 0 view .LVU152
 453 0074 3B41     		asrs	r3, r3, r7
 454              		.loc 1 204 27 view .LVU153
 455 0076 04F8013C 		strb	r3, [r4, #-1]
 205:FreeModbus/app/user_mb_app.c ****             break;
 456              		.loc 1 205 13 is_stmt 1 view .LVU154
 169:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 457              		.loc 1 169 21 is_stmt 0 view .LVU155
 458 007a 4046     		mov	r0, r8
 459              	.LVL66:
 460              		.loc 1 205 13 view .LVU156
 461 007c 1FE0     		b	.L20
 462              	.LVL67:
 463              	.L24:
 206:FreeModbus/app/user_mb_app.c **** 
 207:FreeModbus/app/user_mb_app.c ****             /* write current coil values with new values from the protocol stack. */
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 13


 208:FreeModbus/app/user_mb_app.c ****         case MB_REG_WRITE:
 209:FreeModbus/app/user_mb_app.c ****             while (iNReg > 1)
 210:FreeModbus/app/user_mb_app.c ****             {
 211:FreeModbus/app/user_mb_app.c ****                 xMBUtilSetBits(&pucCoilBuf[iRegIndex++], iRegBitIndex, 8,
 464              		.loc 1 211 17 is_stmt 1 view .LVU157
 465              		.loc 1 211 53 is_stmt 0 view .LVU158
 466 007e 00F10108 		add	r8, r0, #1
 467 0082 1FFA88F8 		uxth	r8, r8
 468              	.LVL68:
 469              		.loc 1 211 17 view .LVU159
 470 0086 14F8013B 		ldrb	r3, [r4], #1	@ zero_extendqisi2
 471              	.LVL69:
 472              		.loc 1 211 17 view .LVU160
 473 008a 0822     		movs	r2, #8
 474 008c 3146     		mov	r1, r6
 475 008e DFF83CC0 		ldr	ip, .L29+8
 476 0092 6044     		add	r0, r0, ip
 477 0094 FFF7FEFF 		bl	xMBUtilSetBits
 478              	.LVL70:
 212:FreeModbus/app/user_mb_app.c ****                         *pucRegBuffer++);
 213:FreeModbus/app/user_mb_app.c ****                 iNReg--;
 479              		.loc 1 213 17 is_stmt 1 view .LVU161
 480              		.loc 1 213 22 is_stmt 0 view .LVU162
 481 0098 013D     		subs	r5, r5, #1
 482              	.LVL71:
 483              		.loc 1 213 22 view .LVU163
 484 009a ADB2     		uxth	r5, r5
 485              	.LVL72:
 211:FreeModbus/app/user_mb_app.c ****                         *pucRegBuffer++);
 486              		.loc 1 211 53 view .LVU164
 487 009c 4046     		mov	r0, r8
 488              	.LVL73:
 489              	.L22:
 209:FreeModbus/app/user_mb_app.c ****             {
 490              		.loc 1 209 19 is_stmt 1 view .LVU165
 491 009e 012D     		cmp	r5, #1
 492 00a0 EDD8     		bhi	.L24
 214:FreeModbus/app/user_mb_app.c ****             }
 215:FreeModbus/app/user_mb_app.c ****             /* last coils */
 216:FreeModbus/app/user_mb_app.c ****             usNCoils = usNCoils % 8;
 493              		.loc 1 216 13 view .LVU166
 494              	.LVL74:
 217:FreeModbus/app/user_mb_app.c ****             /* xMBUtilSetBits has bug when ucNBits is zero */
 218:FreeModbus/app/user_mb_app.c ****             if (usNCoils != 0)
 495              		.loc 1 218 13 view .LVU167
 496              		.loc 1 218 16 is_stmt 0 view .LVU168
 497 00a2 17F00702 		ands	r2, r7, #7
 498 00a6 01D1     		bne	.L28
 169:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 499              		.loc 1 169 21 view .LVU169
 500 00a8 0020     		movs	r0, #0
 501              	.LVL75:
 169:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 502              		.loc 1 169 21 view .LVU170
 503 00aa 08E0     		b	.L20
 504              	.LVL76:
 505              	.L28:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 14


 219:FreeModbus/app/user_mb_app.c ****             {
 220:FreeModbus/app/user_mb_app.c ****                 xMBUtilSetBits(&pucCoilBuf[iRegIndex++], iRegBitIndex, usNCoils,
 506              		.loc 1 220 17 is_stmt 1 view .LVU171
 507              		.loc 1 220 17 is_stmt 0 view .LVU172
 508 00ac 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 509 00ae 3146     		mov	r1, r6
 510 00b0 064C     		ldr	r4, .L29+8
 511              	.LVL77:
 512              		.loc 1 220 17 view .LVU173
 513 00b2 2044     		add	r0, r0, r4
 514              	.LVL78:
 515              		.loc 1 220 17 view .LVU174
 516 00b4 FFF7FEFF 		bl	xMBUtilSetBits
 517              	.LVL79:
 169:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 518              		.loc 1 169 21 view .LVU175
 519 00b8 0020     		movs	r0, #0
 520 00ba 00E0     		b	.L20
 521              	.LVL80:
 522              	.L25:
 221:FreeModbus/app/user_mb_app.c ****                         *pucRegBuffer++);
 222:FreeModbus/app/user_mb_app.c ****             }
 223:FreeModbus/app/user_mb_app.c ****             break;
 224:FreeModbus/app/user_mb_app.c ****         }
 225:FreeModbus/app/user_mb_app.c ****     }
 226:FreeModbus/app/user_mb_app.c ****     else
 227:FreeModbus/app/user_mb_app.c ****     {
 228:FreeModbus/app/user_mb_app.c ****         eStatus = MB_ENOREG;
 523              		.loc 1 228 17 view .LVU176
 524 00bc 0120     		movs	r0, #1
 525              	.LVL81:
 526              	.L20:
 229:FreeModbus/app/user_mb_app.c ****     }
 230:FreeModbus/app/user_mb_app.c ****     return eStatus;
 527              		.loc 1 230 5 is_stmt 1 view .LVU177
 231:FreeModbus/app/user_mb_app.c **** #else
 232:FreeModbus/app/user_mb_app.c **** 	return MB_ENOREG;
 233:FreeModbus/app/user_mb_app.c **** #endif
 234:FreeModbus/app/user_mb_app.c **** }
 528              		.loc 1 234 1 is_stmt 0 view .LVU178
 529 00be BDE8F883 		pop	{r3, r4, r5, r6, r7, r8, r9, pc}
 530              	.L30:
 531 00c2 00BF     		.align	2
 532              	.L29:
 533 00c4 00000000 		.word	.LC0
 534 00c8 00000000 		.word	.LANCHOR4
 535 00cc 00000000 		.word	.LANCHOR5
 536              		.cfi_endproc
 537              	.LFE67:
 539              		.section	.text.eMBRegDiscreteCB,"ax",%progbits
 540              		.align	1
 541              		.global	eMBRegDiscreteCB
 542              		.syntax unified
 543              		.thumb
 544              		.thumb_func
 546              	eMBRegDiscreteCB:
 547              	.LVL82:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 15


 548              	.LFB68:
 235:FreeModbus/app/user_mb_app.c **** 
 236:FreeModbus/app/user_mb_app.c **** /**
 237:FreeModbus/app/user_mb_app.c ****  * Modbus slave discrete callback function.
 238:FreeModbus/app/user_mb_app.c ****  *
 239:FreeModbus/app/user_mb_app.c ****  * @param pucRegBuffer discrete buffer
 240:FreeModbus/app/user_mb_app.c ****  * @param usAddress discrete address
 241:FreeModbus/app/user_mb_app.c ****  * @param usNDiscrete discrete number
 242:FreeModbus/app/user_mb_app.c ****  *
 243:FreeModbus/app/user_mb_app.c ****  * @return result
 244:FreeModbus/app/user_mb_app.c ****  */
 245:FreeModbus/app/user_mb_app.c **** eMBErrorCode eMBRegDiscreteCB( UCHAR * pucRegBuffer, USHORT usAddress, USHORT usNDiscrete )
 246:FreeModbus/app/user_mb_app.c **** {
 549              		.loc 1 246 1 is_stmt 1 view -0
 550              		.cfi_startproc
 551              		@ args = 0, pretend = 0, frame = 0
 552              		@ frame_needed = 0, uses_anonymous_args = 0
 553              		.loc 1 246 1 is_stmt 0 view .LVU180
 554 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 555              	.LCFI5:
 556              		.cfi_def_cfa_offset 24
 557              		.cfi_offset 4, -24
 558              		.cfi_offset 5, -20
 559              		.cfi_offset 6, -16
 560              		.cfi_offset 7, -12
 561              		.cfi_offset 8, -8
 562              		.cfi_offset 14, -4
 563 0004 9046     		mov	r8, r2
 247:FreeModbus/app/user_mb_app.c **** #if S_DISCRETE_INPUT_NDISCRETES > 0
 248:FreeModbus/app/user_mb_app.c ****     eMBErrorCode    eStatus = MB_ENOERR;
 564              		.loc 1 248 5 is_stmt 1 view .LVU181
 565              	.LVL83:
 249:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 566              		.loc 1 249 5 view .LVU182
 250:FreeModbus/app/user_mb_app.c ****     UCHAR *         pucDiscreteInputBuf;
 567              		.loc 1 250 5 view .LVU183
 251:FreeModbus/app/user_mb_app.c ****     USHORT          DISCRETE_INPUT_START;
 568              		.loc 1 251 5 view .LVU184
 252:FreeModbus/app/user_mb_app.c ****     USHORT          DISCRETE_INPUT_NDISCRETES;
 569              		.loc 1 252 5 view .LVU185
 253:FreeModbus/app/user_mb_app.c ****     USHORT          usDiscreteInputStart;
 570              		.loc 1 253 5 view .LVU186
 254:FreeModbus/app/user_mb_app.c ****     iNReg =  usNDiscrete / 8 + 1;
 571              		.loc 1 254 5 view .LVU187
 572              		.loc 1 254 30 is_stmt 0 view .LVU188
 573 0006 D508     		lsrs	r5, r2, #3
 574              	.LVL84:
 255:FreeModbus/app/user_mb_app.c ****     pucDiscreteInputBuf = ucSDiscInBuf;
 575              		.loc 1 255 5 is_stmt 1 view .LVU189
 256:FreeModbus/app/user_mb_app.c ****     DISCRETE_INPUT_START = S_DISCRETE_INPUT_START;
 576              		.loc 1 256 5 view .LVU190
 257:FreeModbus/app/user_mb_app.c ****     DISCRETE_INPUT_NDISCRETES = S_DISCRETE_INPUT_NDISCRETES;
 577              		.loc 1 257 5 view .LVU191
 258:FreeModbus/app/user_mb_app.c ****     usDiscreteInputStart = usSDiscInStart;
 578              		.loc 1 258 5 view .LVU192
 579              		.loc 1 258 26 is_stmt 0 view .LVU193
 580 0008 194B     		ldr	r3, .L37
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 16


 581 000a 1A88     		ldrh	r2, [r3]
 582              	.LVL85:
 259:FreeModbus/app/user_mb_app.c **** 
 260:FreeModbus/app/user_mb_app.c ****     /* it already plus one in modbus function method. */
 261:FreeModbus/app/user_mb_app.c ****     usAddress--;
 583              		.loc 1 261 5 is_stmt 1 view .LVU194
 584              		.loc 1 261 14 is_stmt 0 view .LVU195
 585 000c 4F1E     		subs	r7, r1, #1
 586 000e BFB2     		uxth	r7, r7
 587              	.LVL86:
 262:FreeModbus/app/user_mb_app.c **** 
 263:FreeModbus/app/user_mb_app.c ****     if ((usAddress >= DISCRETE_INPUT_START) && (usAddress + usNDiscrete    <= DISCRETE_INPUT_START 
 588              		.loc 1 263 5 is_stmt 1 view .LVU196
 589              		.loc 1 263 59 is_stmt 0 view .LVU197
 590 0010 07EB0803 		add	r3, r7, r8
 591              		.loc 1 263 45 view .LVU198
 592 0014 102B     		cmp	r3, #16
 593 0016 28DC     		bgt	.L35
 594 0018 0446     		mov	r4, r0
 595 001a 0135     		adds	r5, r5, #1
 596              	.LVL87:
 264:FreeModbus/app/user_mb_app.c ****     {
 265:FreeModbus/app/user_mb_app.c ****         iRegIndex = (USHORT) (usAddress - usDiscreteInputStart) / 8;
 597              		.loc 1 265 9 is_stmt 1 view .LVU199
 598              		.loc 1 265 21 is_stmt 0 view .LVU200
 599 001c BF1A     		subs	r7, r7, r2
 600              	.LVL88:
 601              		.loc 1 265 19 view .LVU201
 602 001e C7F3CC03 		ubfx	r3, r7, #3, #13
 603              	.LVL89:
 266:FreeModbus/app/user_mb_app.c ****         iRegBitIndex = (USHORT) (usAddress - usDiscreteInputStart) % 8;
 604              		.loc 1 266 9 is_stmt 1 view .LVU202
 605              		.loc 1 266 22 is_stmt 0 view .LVU203
 606 0022 07F00707 		and	r7, r7, #7
 607              	.LVL90:
 267:FreeModbus/app/user_mb_app.c **** 
 268:FreeModbus/app/user_mb_app.c ****         while (iNReg > 0)
 608              		.loc 1 268 9 is_stmt 1 view .LVU204
 609              		.loc 1 268 15 is_stmt 0 view .LVU205
 610 0026 0CE0     		b	.L33
 611              	.LVL91:
 612              	.L34:
 269:FreeModbus/app/user_mb_app.c ****         {
 270:FreeModbus/app/user_mb_app.c ****             *pucRegBuffer++ = xMBUtilGetBits(&pucDiscreteInputBuf[iRegIndex++],
 613              		.loc 1 270 13 is_stmt 1 view .LVU206
 614              		.loc 1 270 76 is_stmt 0 view .LVU207
 615 0028 5E1C     		adds	r6, r3, #1
 616 002a B6B2     		uxth	r6, r6
 617              	.LVL92:
 618              		.loc 1 270 31 view .LVU208
 619 002c 0822     		movs	r2, #8
 620 002e 3946     		mov	r1, r7
 621 0030 1048     		ldr	r0, .L37+4
 622 0032 1844     		add	r0, r0, r3
 623 0034 FFF7FEFF 		bl	xMBUtilGetBits
 624              	.LVL93:
 625              		.loc 1 270 29 view .LVU209
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 17


 626 0038 04F8010B 		strb	r0, [r4], #1
 627              	.LVL94:
 271:FreeModbus/app/user_mb_app.c ****                     iRegBitIndex, 8);
 272:FreeModbus/app/user_mb_app.c ****             iNReg--;
 628              		.loc 1 272 13 is_stmt 1 view .LVU210
 629              		.loc 1 272 18 is_stmt 0 view .LVU211
 630 003c 013D     		subs	r5, r5, #1
 631              	.LVL95:
 632              		.loc 1 272 18 view .LVU212
 633 003e ADB2     		uxth	r5, r5
 634              	.LVL96:
 270:FreeModbus/app/user_mb_app.c ****                     iRegBitIndex, 8);
 635              		.loc 1 270 76 view .LVU213
 636 0040 3346     		mov	r3, r6
 637              	.LVL97:
 638              	.L33:
 268:FreeModbus/app/user_mb_app.c ****         {
 639              		.loc 1 268 15 is_stmt 1 view .LVU214
 640 0042 002D     		cmp	r5, #0
 641 0044 F0D1     		bne	.L34
 273:FreeModbus/app/user_mb_app.c ****         }
 274:FreeModbus/app/user_mb_app.c ****         pucRegBuffer--;
 642              		.loc 1 274 9 view .LVU215
 643              	.LVL98:
 275:FreeModbus/app/user_mb_app.c ****         /* last discrete */
 276:FreeModbus/app/user_mb_app.c ****         usNDiscrete = usNDiscrete % 8;
 644              		.loc 1 276 9 view .LVU216
 645              		.loc 1 276 21 is_stmt 0 view .LVU217
 646 0046 08F00708 		and	r8, r8, #7
 647              	.LVL99:
 277:FreeModbus/app/user_mb_app.c ****         /* filling zero to high bit */
 278:FreeModbus/app/user_mb_app.c ****         *pucRegBuffer = *pucRegBuffer << (8 - usNDiscrete);
 648              		.loc 1 278 9 is_stmt 1 view .LVU218
 649              		.loc 1 278 25 is_stmt 0 view .LVU219
 650 004a 14F8013C 		ldrb	r3, [r4, #-1]	@ zero_extendqisi2
 651              	.LVL100:
 652              		.loc 1 278 45 view .LVU220
 653 004e C8F10808 		rsb	r8, r8, #8
 654              	.LVL101:
 655              		.loc 1 278 39 view .LVU221
 656 0052 03FA08F3 		lsl	r3, r3, r8
 657              		.loc 1 278 23 view .LVU222
 658 0056 DBB2     		uxtb	r3, r3
 659 0058 04F8013C 		strb	r3, [r4, #-1]
 279:FreeModbus/app/user_mb_app.c ****         *pucRegBuffer = *pucRegBuffer >> (8 - usNDiscrete);
 660              		.loc 1 279 9 is_stmt 1 view .LVU223
 661              		.loc 1 279 39 is_stmt 0 view .LVU224
 662 005c 43FA08F8 		asr	r8, r3, r8
 663              		.loc 1 279 23 view .LVU225
 664 0060 04F8018C 		strb	r8, [r4, #-1]
 248:FreeModbus/app/user_mb_app.c ****     USHORT          iRegIndex , iRegBitIndex , iNReg;
 665              		.loc 1 248 21 view .LVU226
 666 0064 0020     		movs	r0, #0
 667              	.LVL102:
 668              	.L32:
 280:FreeModbus/app/user_mb_app.c ****     }
 281:FreeModbus/app/user_mb_app.c ****     else
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 18


 282:FreeModbus/app/user_mb_app.c ****     {
 283:FreeModbus/app/user_mb_app.c ****         eStatus = MB_ENOREG;
 284:FreeModbus/app/user_mb_app.c ****     }
 285:FreeModbus/app/user_mb_app.c **** 
 286:FreeModbus/app/user_mb_app.c ****     return eStatus;
 669              		.loc 1 286 5 is_stmt 1 view .LVU227
 287:FreeModbus/app/user_mb_app.c **** #else
 288:FreeModbus/app/user_mb_app.c **** 	return MB_ENOREG;
 289:FreeModbus/app/user_mb_app.c **** #endif
 290:FreeModbus/app/user_mb_app.c **** }
 670              		.loc 1 290 1 is_stmt 0 view .LVU228
 671 0066 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 672              	.LVL103:
 673              	.L35:
 283:FreeModbus/app/user_mb_app.c ****     }
 674              		.loc 1 283 17 view .LVU229
 675 006a 0120     		movs	r0, #1
 676              	.LVL104:
 283:FreeModbus/app/user_mb_app.c ****     }
 677              		.loc 1 283 17 view .LVU230
 678 006c FBE7     		b	.L32
 679              	.L38:
 680 006e 00BF     		.align	2
 681              	.L37:
 682 0070 00000000 		.word	.LANCHOR6
 683 0074 00000000 		.word	.LANCHOR7
 684              		.cfi_endproc
 685              	.LFE68:
 687              		.global	usSRegHoldBuf
 688              		.global	usSRegHoldStart
 689              		.global	usSRegInBuf
 690              		.global	usSRegInStart
 691              		.global	ucSCoilBuf
 692              		.global	usSCoilStart
 693              		.global	ucSDiscInBuf
 694              		.global	usSDiscInStart
 695              		.section	.bss.ucSCoilBuf,"aw",%nobits
 696              		.align	2
 697              		.set	.LANCHOR5,. + 0
 700              	ucSCoilBuf:
 701 0000 0000     		.space	2
 702              		.section	.bss.ucSDiscInBuf,"aw",%nobits
 703              		.align	2
 704              		.set	.LANCHOR7,. + 0
 707              	ucSDiscInBuf:
 708 0000 0000     		.space	2
 709              		.section	.bss.usSCoilStart,"aw",%nobits
 710              		.align	1
 711              		.set	.LANCHOR4,. + 0
 714              	usSCoilStart:
 715 0000 0000     		.space	2
 716              		.section	.bss.usSDiscInStart,"aw",%nobits
 717              		.align	1
 718              		.set	.LANCHOR6,. + 0
 721              	usSDiscInStart:
 722 0000 0000     		.space	2
 723              		.section	.bss.usSRegHoldBuf,"aw",%nobits
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 19


 724              		.align	2
 725              		.set	.LANCHOR3,. + 0
 728              	usSRegHoldBuf:
 729 0000 00000000 		.space	200
 729      00000000 
 729      00000000 
 729      00000000 
 729      00000000 
 730              		.section	.bss.usSRegHoldStart,"aw",%nobits
 731              		.align	1
 732              		.set	.LANCHOR2,. + 0
 735              	usSRegHoldStart:
 736 0000 0000     		.space	2
 737              		.section	.bss.usSRegInBuf,"aw",%nobits
 738              		.align	2
 739              		.set	.LANCHOR1,. + 0
 742              	usSRegInBuf:
 743 0000 00000000 		.space	200
 743      00000000 
 743      00000000 
 743      00000000 
 743      00000000 
 744              		.section	.bss.usSRegInStart,"aw",%nobits
 745              		.align	1
 746              		.set	.LANCHOR0,. + 0
 749              	usSRegInStart:
 750 0000 0000     		.space	2
 751              		.text
 752              	.Letext0:
 753              		.file 2 "e:\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\machine\\_default_typ
 754              		.file 3 "e:\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\sys\\_stdint.h"
 755              		.file 4 "FreeModbus/port/port.h"
 756              		.file 5 "FreeModbus/include/mb.h"
 757              		.file 6 "FreeModbus/app/user_mb_app.h"
 758              		.file 7 "FreeModbus/include/mbutils.h"
 759              		.file 8 "<built-in>"
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s 			page 20


DEFINED SYMBOLS
                            *ABS*:00000000 user_mb_app.c
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:18     .text.eMBRegInputCB:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:24     .text.eMBRegInputCB:00000000 eMBRegInputCB
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:137    .text.eMBRegInputCB:00000044 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:143    .text.eMBRegHoldingCB:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:149    .text.eMBRegHoldingCB:00000000 eMBRegHoldingCB
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:306    .text.eMBRegHoldingCB:00000078 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:312    .rodata.eMBRegCoilsCB.str1.4:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:316    .text.eMBRegCoilsCB:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:322    .text.eMBRegCoilsCB:00000000 eMBRegCoilsCB
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:533    .text.eMBRegCoilsCB:000000c4 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:540    .text.eMBRegDiscreteCB:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:546    .text.eMBRegDiscreteCB:00000000 eMBRegDiscreteCB
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:682    .text.eMBRegDiscreteCB:00000070 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:728    .bss.usSRegHoldBuf:00000000 usSRegHoldBuf
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:735    .bss.usSRegHoldStart:00000000 usSRegHoldStart
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:742    .bss.usSRegInBuf:00000000 usSRegInBuf
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:749    .bss.usSRegInStart:00000000 usSRegInStart
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:700    .bss.ucSCoilBuf:00000000 ucSCoilBuf
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:714    .bss.usSCoilStart:00000000 usSCoilStart
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:707    .bss.ucSDiscInBuf:00000000 ucSDiscInBuf
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:721    .bss.usSDiscInStart:00000000 usSDiscInStart
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:696    .bss.ucSCoilBuf:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:703    .bss.ucSDiscInBuf:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:710    .bss.usSCoilStart:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:717    .bss.usSDiscInStart:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:724    .bss.usSRegHoldBuf:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:731    .bss.usSRegHoldStart:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:738    .bss.usSRegInBuf:00000000 $d
C:\Users\BLACK_~1\AppData\Local\Temp\ccu9nECe.s:745    .bss.usSRegInStart:00000000 $d

UNDEFINED SYMBOLS
puts
xMBUtilGetBits
xMBUtilSetBits
