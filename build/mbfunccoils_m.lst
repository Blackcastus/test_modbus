ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"mbfunccoils_m.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.eMBMasterReqReadCoils,"ax",%progbits
  18              		.align	1
  19              		.global	eMBMasterReqReadCoils
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	eMBMasterReqReadCoils:
  25              	.LVL0:
  26              	.LFB65:
  27              		.file 1 "FreeModbus/functions/mbfunccoils_m.c"
   1:FreeModbus/functions/mbfunccoils_m.c **** /* 
   2:FreeModbus/functions/mbfunccoils_m.c ****  * FreeModbus Libary: A portable Modbus implementation for Modbus ASCII/RTU.
   3:FreeModbus/functions/mbfunccoils_m.c ****  * Copyright (C) 2013 Armink <armink.ztl@gmail.com>
   4:FreeModbus/functions/mbfunccoils_m.c ****  * All rights reserved.
   5:FreeModbus/functions/mbfunccoils_m.c ****  *
   6:FreeModbus/functions/mbfunccoils_m.c ****  * Redistribution and use in source and binary forms, with or without
   7:FreeModbus/functions/mbfunccoils_m.c ****  * modification, are permitted provided that the following conditions
   8:FreeModbus/functions/mbfunccoils_m.c ****  * are met:
   9:FreeModbus/functions/mbfunccoils_m.c ****  * 1. Redistributions of source code must retain the above copyright
  10:FreeModbus/functions/mbfunccoils_m.c ****  *    notice, this list of conditions and the following disclaimer.
  11:FreeModbus/functions/mbfunccoils_m.c ****  * 2. Redistributions in binary form must reproduce the above copyright
  12:FreeModbus/functions/mbfunccoils_m.c ****  *    notice, this list of conditions and the following disclaimer in the
  13:FreeModbus/functions/mbfunccoils_m.c ****  *    documentation and/or other materials provided with the distribution.
  14:FreeModbus/functions/mbfunccoils_m.c ****  * 3. The name of the author may not be used to endorse or promote products
  15:FreeModbus/functions/mbfunccoils_m.c ****  *    derived from this software without specific prior written permission.
  16:FreeModbus/functions/mbfunccoils_m.c ****  *
  17:FreeModbus/functions/mbfunccoils_m.c ****  * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
  18:FreeModbus/functions/mbfunccoils_m.c ****  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
  19:FreeModbus/functions/mbfunccoils_m.c ****  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
  20:FreeModbus/functions/mbfunccoils_m.c ****  * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
  21:FreeModbus/functions/mbfunccoils_m.c ****  * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
  22:FreeModbus/functions/mbfunccoils_m.c ****  * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
  23:FreeModbus/functions/mbfunccoils_m.c ****  * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
  24:FreeModbus/functions/mbfunccoils_m.c ****  * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  25:FreeModbus/functions/mbfunccoils_m.c ****  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  26:FreeModbus/functions/mbfunccoils_m.c ****  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  27:FreeModbus/functions/mbfunccoils_m.c ****  *
  28:FreeModbus/functions/mbfunccoils_m.c ****  * File: $Id: mbfunccoils_m.c,v 1.60 2013/10/12 15:10:12 Armink Add Master Functions
  29:FreeModbus/functions/mbfunccoils_m.c ****  */
  30:FreeModbus/functions/mbfunccoils_m.c **** 
  31:FreeModbus/functions/mbfunccoils_m.c **** /* ----------------------- System includes ----------------------------------*/
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 2


  32:FreeModbus/functions/mbfunccoils_m.c **** #include "stdlib.h"
  33:FreeModbus/functions/mbfunccoils_m.c **** #include "string.h"
  34:FreeModbus/functions/mbfunccoils_m.c **** 
  35:FreeModbus/functions/mbfunccoils_m.c **** /* ----------------------- Platform includes --------------------------------*/
  36:FreeModbus/functions/mbfunccoils_m.c **** #include "port.h"
  37:FreeModbus/functions/mbfunccoils_m.c **** 
  38:FreeModbus/functions/mbfunccoils_m.c **** /* ----------------------- Modbus includes ----------------------------------*/
  39:FreeModbus/functions/mbfunccoils_m.c **** #include "mb.h"
  40:FreeModbus/functions/mbfunccoils_m.c **** #include "mb_m.h"
  41:FreeModbus/functions/mbfunccoils_m.c **** #include "mbframe.h"
  42:FreeModbus/functions/mbfunccoils_m.c **** #include "mbproto.h"
  43:FreeModbus/functions/mbfunccoils_m.c **** #include "mbconfig.h"
  44:FreeModbus/functions/mbfunccoils_m.c **** 
  45:FreeModbus/functions/mbfunccoils_m.c **** /* ----------------------- Defines ------------------------------------------*/
  46:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_READ_ADDR_OFF            ( MB_PDU_DATA_OFF + 0 )
  47:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_READ_COILCNT_OFF         ( MB_PDU_DATA_OFF + 2 )
  48:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_READ_SIZE                ( 4 )
  49:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_READ_COILCNT_OFF        ( MB_PDU_DATA_OFF + 0 )
  50:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_READ_VALUES_OFF         ( MB_PDU_DATA_OFF + 1 )
  51:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_READ_SIZE_MIN           ( 1 )
  52:FreeModbus/functions/mbfunccoils_m.c **** 
  53:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_ADDR_OFF           ( MB_PDU_DATA_OFF )
  54:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_VALUE_OFF          ( MB_PDU_DATA_OFF + 2 )
  55:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_SIZE               ( 4 )
  56:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_WRITE_ADDR_OFF          ( MB_PDU_DATA_OFF )
  57:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_WRITE_VALUE_OFF         ( MB_PDU_DATA_OFF + 2 )
  58:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_WRITE_SIZE              ( 4 )
  59:FreeModbus/functions/mbfunccoils_m.c **** 
  60:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_MUL_ADDR_OFF       ( MB_PDU_DATA_OFF )
  61:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_MUL_COILCNT_OFF    ( MB_PDU_DATA_OFF + 2 )
  62:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_MUL_BYTECNT_OFF    ( MB_PDU_DATA_OFF + 4 )
  63:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_MUL_VALUES_OFF     ( MB_PDU_DATA_OFF + 5 )
  64:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_MUL_SIZE_MIN       ( 5 )
  65:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_REQ_WRITE_MUL_COILCNT_MAX    ( 0x07B0 )
  66:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_WRITE_MUL_ADDR_OFF      ( MB_PDU_DATA_OFF )
  67:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_WRITE_MUL_COILCNT_OFF   ( MB_PDU_DATA_OFF + 2 )
  68:FreeModbus/functions/mbfunccoils_m.c **** #define MB_PDU_FUNC_WRITE_MUL_SIZE          ( 5 )
  69:FreeModbus/functions/mbfunccoils_m.c **** 
  70:FreeModbus/functions/mbfunccoils_m.c **** /* ----------------------- Static functions ---------------------------------*/
  71:FreeModbus/functions/mbfunccoils_m.c **** eMBException    prveMBError2Exception( eMBErrorCode eErrorCode );
  72:FreeModbus/functions/mbfunccoils_m.c **** 
  73:FreeModbus/functions/mbfunccoils_m.c **** /* ----------------------- Start implementation -----------------------------*/
  74:FreeModbus/functions/mbfunccoils_m.c **** #if MB_MASTER_RTU_ENABLED > 0 || MB_MASTER_ASCII_ENABLED > 0
  75:FreeModbus/functions/mbfunccoils_m.c **** #if MB_FUNC_READ_COILS_ENABLED > 0
  76:FreeModbus/functions/mbfunccoils_m.c **** 
  77:FreeModbus/functions/mbfunccoils_m.c **** /**
  78:FreeModbus/functions/mbfunccoils_m.c ****  * This function will request read coil.
  79:FreeModbus/functions/mbfunccoils_m.c ****  *
  80:FreeModbus/functions/mbfunccoils_m.c ****  * @param ucSndAddr salve address
  81:FreeModbus/functions/mbfunccoils_m.c ****  * @param usCoilAddr coil start address
  82:FreeModbus/functions/mbfunccoils_m.c ****  * @param usNCoils coil total number
  83:FreeModbus/functions/mbfunccoils_m.c ****  * @param lTimeOut timeout (-1 will waiting forever)
  84:FreeModbus/functions/mbfunccoils_m.c ****  *
  85:FreeModbus/functions/mbfunccoils_m.c ****  * @return error code
  86:FreeModbus/functions/mbfunccoils_m.c ****  */
  87:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterReqErrCode
  88:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterReqReadCoils( UCHAR ucSndAddr, USHORT usCoilAddr, USHORT usNCoils ,LONG lTimeOut )
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 3


  89:FreeModbus/functions/mbfunccoils_m.c **** {
  28              		.loc 1 89 1 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 8
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  90:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                 *ucMBFrame;
  32              		.loc 1 90 5 view .LVU1
  91:FreeModbus/functions/mbfunccoils_m.c ****     eMBMasterReqErrCode    eErrStatus = MB_MRE_NO_ERR;
  33              		.loc 1 91 5 view .LVU2
  92:FreeModbus/functions/mbfunccoils_m.c **** 
  93:FreeModbus/functions/mbfunccoils_m.c ****     if ( ucSndAddr > MB_MASTER_TOTAL_SLAVE_NUM ) eErrStatus = MB_MRE_ILL_ARG;
  34              		.loc 1 93 5 view .LVU3
  35              		.loc 1 93 8 is_stmt 0 view .LVU4
  36 0000 1028     		cmp	r0, #16
  37 0002 01D9     		bls	.L9
  38              		.loc 1 93 61 view .LVU5
  39 0004 0220     		movs	r0, #2
  40              	.LVL1:
  94:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
  95:FreeModbus/functions/mbfunccoils_m.c ****     else
  96:FreeModbus/functions/mbfunccoils_m.c ****     {
  97:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterGetPDUSndBuf(&ucMBFrame);
  98:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetDestAddress(ucSndAddr);
  99:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_FUNC_OFF]                 = MB_FUNC_READ_COILS;
 100:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF]        = usCoilAddr >> 8;
 101:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF + 1]    = usCoilAddr;
 102:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF ]    = usNCoils >> 8;
 103:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF + 1] = usNCoils;
 104:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_READ_SIZE );
 105:FreeModbus/functions/mbfunccoils_m.c **** 		( void ) xMBMasterPortEventPost( EV_MASTER_FRAME_SENT );
 106:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 107:FreeModbus/functions/mbfunccoils_m.c **** 
 108:FreeModbus/functions/mbfunccoils_m.c ****     }
 109:FreeModbus/functions/mbfunccoils_m.c ****     return eErrStatus;
  41              		.loc 1 109 5 is_stmt 1 view .LVU6
 110:FreeModbus/functions/mbfunccoils_m.c **** }
  42              		.loc 1 110 1 is_stmt 0 view .LVU7
  43 0006 7047     		bx	lr
  44              	.LVL2:
  45              	.L9:
  89:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                 *ucMBFrame;
  46              		.loc 1 89 1 view .LVU8
  47 0008 F0B5     		push	{r4, r5, r6, r7, lr}
  48              	.LCFI0:
  49              		.cfi_def_cfa_offset 20
  50              		.cfi_offset 4, -20
  51              		.cfi_offset 5, -16
  52              		.cfi_offset 6, -12
  53              		.cfi_offset 7, -8
  54              		.cfi_offset 14, -4
  55 000a 83B0     		sub	sp, sp, #12
  56              	.LCFI1:
  57              		.cfi_def_cfa_offset 32
  58 000c 0446     		mov	r4, r0
  59 000e 0F46     		mov	r7, r1
  60 0010 1646     		mov	r6, r2
  61 0012 1D46     		mov	r5, r3
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 4


  94:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
  62              		.loc 1 94 10 is_stmt 1 view .LVU9
  94:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
  63              		.loc 1 94 15 is_stmt 0 view .LVU10
  64 0014 1846     		mov	r0, r3
  65              	.LVL3:
  94:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
  66              		.loc 1 94 15 view .LVU11
  67 0016 FFF7FEFF 		bl	xMBMasterRunResTake
  68              	.LVL4:
  94:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
  69              		.loc 1 94 13 view .LVU12
  70 001a 10B9     		cbnz	r0, .L10
  94:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
  71              		.loc 1 94 69 view .LVU13
  72 001c 0520     		movs	r0, #5
  73              	.LVL5:
  74              	.L2:
 109:FreeModbus/functions/mbfunccoils_m.c **** }
  75              		.loc 1 109 5 is_stmt 1 view .LVU14
  76              		.loc 1 110 1 is_stmt 0 view .LVU15
  77 001e 03B0     		add	sp, sp, #12
  78              	.LCFI2:
  79              		.cfi_remember_state
  80              		.cfi_def_cfa_offset 20
  81              		@ sp needed
  82 0020 F0BD     		pop	{r4, r5, r6, r7, pc}
  83              	.LVL6:
  84              	.L10:
  85              	.LCFI3:
  86              		.cfi_restore_state
  97:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetDestAddress(ucSndAddr);
  87              		.loc 1 97 3 is_stmt 1 view .LVU16
  88 0022 01A8     		add	r0, sp, #4
  89 0024 FFF7FEFF 		bl	vMBMasterGetPDUSndBuf
  90              	.LVL7:
  98:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_FUNC_OFF]                 = MB_FUNC_READ_COILS;
  91              		.loc 1 98 3 view .LVU17
  92 0028 2046     		mov	r0, r4
  93 002a FFF7FEFF 		bl	vMBMasterSetDestAddress
  94              	.LVL8:
  99:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF]        = usCoilAddr >> 8;
  95              		.loc 1 99 3 view .LVU18
  99:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF]        = usCoilAddr >> 8;
  96              		.loc 1 99 46 is_stmt 0 view .LVU19
  97 002e 019B     		ldr	r3, [sp, #4]
  98 0030 0122     		movs	r2, #1
  99 0032 1A70     		strb	r2, [r3]
 100:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF + 1]    = usCoilAddr;
 100              		.loc 1 100 3 is_stmt 1 view .LVU20
 100:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF + 1]    = usCoilAddr;
 101              		.loc 1 100 46 is_stmt 0 view .LVU21
 102 0034 3A0A     		lsrs	r2, r7, #8
 103 0036 019B     		ldr	r3, [sp, #4]
 104 0038 5A70     		strb	r2, [r3, #1]
 101:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF ]    = usNCoils >> 8;
 105              		.loc 1 101 3 is_stmt 1 view .LVU22
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 5


 101:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF ]    = usNCoils >> 8;
 106              		.loc 1 101 12 is_stmt 0 view .LVU23
 107 003a 019B     		ldr	r3, [sp, #4]
 101:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF ]    = usNCoils >> 8;
 108              		.loc 1 101 46 view .LVU24
 109 003c 9F70     		strb	r7, [r3, #2]
 102:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF + 1] = usNCoils;
 110              		.loc 1 102 3 is_stmt 1 view .LVU25
 102:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF + 1] = usNCoils;
 111              		.loc 1 102 46 is_stmt 0 view .LVU26
 112 003e 320A     		lsrs	r2, r6, #8
 113 0040 019B     		ldr	r3, [sp, #4]
 114 0042 DA70     		strb	r2, [r3, #3]
 103:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_READ_SIZE );
 115              		.loc 1 103 3 is_stmt 1 view .LVU27
 103:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_READ_SIZE );
 116              		.loc 1 103 12 is_stmt 0 view .LVU28
 117 0044 019B     		ldr	r3, [sp, #4]
 103:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_READ_SIZE );
 118              		.loc 1 103 46 view .LVU29
 119 0046 1E71     		strb	r6, [r3, #4]
 104:FreeModbus/functions/mbfunccoils_m.c **** 		( void ) xMBMasterPortEventPost( EV_MASTER_FRAME_SENT );
 120              		.loc 1 104 3 is_stmt 1 view .LVU30
 121 0048 0520     		movs	r0, #5
 122 004a FFF7FEFF 		bl	vMBMasterSetPDUSndLength
 123              	.LVL9:
 105:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 124              		.loc 1 105 3 view .LVU31
 105:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 125              		.loc 1 105 12 is_stmt 0 view .LVU32
 126 004e 0820     		movs	r0, #8
 127 0050 FFF7FEFF 		bl	xMBMasterPortEventPost
 128              	.LVL10:
 106:FreeModbus/functions/mbfunccoils_m.c **** 
 129              		.loc 1 106 3 is_stmt 1 view .LVU33
 106:FreeModbus/functions/mbfunccoils_m.c **** 
 130              		.loc 1 106 16 is_stmt 0 view .LVU34
 131 0054 2846     		mov	r0, r5
 132 0056 FFF7FEFF 		bl	eMBMasterWaitRequestFinish
 133              	.LVL11:
 106:FreeModbus/functions/mbfunccoils_m.c **** 
 134              		.loc 1 106 16 view .LVU35
 135 005a E0E7     		b	.L2
 136              		.cfi_endproc
 137              	.LFE65:
 139              		.section	.text.eMBMasterFuncReadCoils,"ax",%progbits
 140              		.align	1
 141              		.global	eMBMasterFuncReadCoils
 142              		.syntax unified
 143              		.thumb
 144              		.thumb_func
 146              	eMBMasterFuncReadCoils:
 147              	.LVL12:
 148              	.LFB66:
 111:FreeModbus/functions/mbfunccoils_m.c **** 
 112:FreeModbus/functions/mbfunccoils_m.c **** eMBException
 113:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterFuncReadCoils( UCHAR * pucFrame, USHORT * usLen )
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 6


 114:FreeModbus/functions/mbfunccoils_m.c **** {
 149              		.loc 1 114 1 is_stmt 1 view -0
 150              		.cfi_startproc
 151              		@ args = 0, pretend = 0, frame = 8
 152              		@ frame_needed = 0, uses_anonymous_args = 0
 153              		.loc 1 114 1 is_stmt 0 view .LVU37
 154 0000 30B5     		push	{r4, r5, lr}
 155              	.LCFI4:
 156              		.cfi_def_cfa_offset 12
 157              		.cfi_offset 4, -12
 158              		.cfi_offset 5, -8
 159              		.cfi_offset 14, -4
 160 0002 83B0     		sub	sp, sp, #12
 161              	.LCFI5:
 162              		.cfi_def_cfa_offset 24
 163 0004 0546     		mov	r5, r0
 164 0006 0C46     		mov	r4, r1
 115:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR          *ucMBFrame;
 165              		.loc 1 115 5 is_stmt 1 view .LVU38
 116:FreeModbus/functions/mbfunccoils_m.c ****     USHORT          usRegAddress;
 166              		.loc 1 116 5 view .LVU39
 117:FreeModbus/functions/mbfunccoils_m.c ****     USHORT          usCoilCount;
 167              		.loc 1 117 5 view .LVU40
 118:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR           ucByteCount;
 168              		.loc 1 118 5 view .LVU41
 119:FreeModbus/functions/mbfunccoils_m.c **** 
 120:FreeModbus/functions/mbfunccoils_m.c ****     eMBException    eStatus = MB_EX_NONE;
 169              		.loc 1 120 5 view .LVU42
 170              	.LVL13:
 121:FreeModbus/functions/mbfunccoils_m.c ****     eMBErrorCode    eRegStatus;
 171              		.loc 1 121 5 view .LVU43
 122:FreeModbus/functions/mbfunccoils_m.c **** 
 123:FreeModbus/functions/mbfunccoils_m.c ****     /* If this request is broadcast, and it's read mode. This request don't need execute. */
 124:FreeModbus/functions/mbfunccoils_m.c ****     if ( xMBMasterRequestIsBroadcast() )
 172              		.loc 1 124 5 view .LVU44
 173              		.loc 1 124 10 is_stmt 0 view .LVU45
 174 0008 FFF7FEFF 		bl	xMBMasterRequestIsBroadcast
 175              	.LVL14:
 176              		.loc 1 124 8 view .LVU46
 177 000c 40BB     		cbnz	r0, .L15
 125:FreeModbus/functions/mbfunccoils_m.c ****     {
 126:FreeModbus/functions/mbfunccoils_m.c ****     	eStatus = MB_EX_NONE;
 127:FreeModbus/functions/mbfunccoils_m.c ****     }
 128:FreeModbus/functions/mbfunccoils_m.c ****     else if ( *usLen >= MB_PDU_SIZE_MIN + MB_PDU_FUNC_READ_SIZE_MIN )
 178              		.loc 1 128 10 is_stmt 1 view .LVU47
 179              		.loc 1 128 15 is_stmt 0 view .LVU48
 180 000e 2388     		ldrh	r3, [r4]
 181              		.loc 1 128 13 view .LVU49
 182 0010 012B     		cmp	r3, #1
 183 0012 28D9     		bls	.L16
 129:FreeModbus/functions/mbfunccoils_m.c ****     {
 130:FreeModbus/functions/mbfunccoils_m.c ****     	vMBMasterGetPDUSndBuf(&ucMBFrame);
 184              		.loc 1 130 6 is_stmt 1 view .LVU50
 185 0014 01A8     		add	r0, sp, #4
 186 0016 FFF7FEFF 		bl	vMBMasterGetPDUSndBuf
 187              	.LVL15:
 131:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress = ( USHORT )( ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF] << 8 );
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 7


 188              		.loc 1 131 9 view .LVU51
 189              		.loc 1 131 45 is_stmt 0 view .LVU52
 190 001a 019B     		ldr	r3, [sp, #4]
 191 001c 5A78     		ldrb	r2, [r3, #1]	@ zero_extendqisi2
 192              	.LVL16:
 132:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress |= ( USHORT )( ucMBFrame[MB_PDU_REQ_READ_ADDR_OFF + 1] );
 193              		.loc 1 132 9 is_stmt 1 view .LVU53
 194              		.loc 1 132 46 is_stmt 0 view .LVU54
 195 001e 9978     		ldrb	r1, [r3, #2]	@ zero_extendqisi2
 196              		.loc 1 132 22 view .LVU55
 197 0020 41EA0221 		orr	r1, r1, r2, lsl #8
 198              	.LVL17:
 133:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress++;
 199              		.loc 1 133 9 is_stmt 1 view .LVU56
 200              		.loc 1 133 21 is_stmt 0 view .LVU57
 201 0024 0131     		adds	r1, r1, #1
 202              	.LVL18:
 203              		.loc 1 133 21 view .LVU58
 204 0026 89B2     		uxth	r1, r1
 205              	.LVL19:
 134:FreeModbus/functions/mbfunccoils_m.c **** 
 135:FreeModbus/functions/mbfunccoils_m.c ****         usCoilCount = ( USHORT )( ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF] << 8 );
 206              		.loc 1 135 9 is_stmt 1 view .LVU59
 207              		.loc 1 135 44 is_stmt 0 view .LVU60
 208 0028 DA78     		ldrb	r2, [r3, #3]	@ zero_extendqisi2
 209              	.LVL20:
 136:FreeModbus/functions/mbfunccoils_m.c ****         usCoilCount |= ( USHORT )( ucMBFrame[MB_PDU_REQ_READ_COILCNT_OFF + 1] );
 210              		.loc 1 136 9 is_stmt 1 view .LVU61
 211              		.loc 1 136 45 is_stmt 0 view .LVU62
 212 002a 1B79     		ldrb	r3, [r3, #4]	@ zero_extendqisi2
 213              		.loc 1 136 21 view .LVU63
 214 002c 43EA0222 		orr	r2, r3, r2, lsl #8
 215              	.LVL21:
 137:FreeModbus/functions/mbfunccoils_m.c **** 
 138:FreeModbus/functions/mbfunccoils_m.c ****         /* Test if the quantity of coils is a multiple of 8. If not last
 139:FreeModbus/functions/mbfunccoils_m.c ****          * byte is only partially field with unused coils set to zero. */
 140:FreeModbus/functions/mbfunccoils_m.c ****         if( ( usCoilCount & 0x0007 ) != 0 )
 216              		.loc 1 140 9 is_stmt 1 view .LVU64
 217              		.loc 1 140 11 is_stmt 0 view .LVU65
 218 0030 13F0070F 		tst	r3, #7
 219 0034 09D0     		beq	.L13
 141:FreeModbus/functions/mbfunccoils_m.c ****         {
 142:FreeModbus/functions/mbfunccoils_m.c ****         	ucByteCount = ( UCHAR )( usCoilCount / 8 + 1 );
 220              		.loc 1 142 10 is_stmt 1 view .LVU66
 221              		.loc 1 142 24 is_stmt 0 view .LVU67
 222 0036 C2F3C703 		ubfx	r3, r2, #3, #8
 223              		.loc 1 142 22 view .LVU68
 224 003a 0133     		adds	r3, r3, #1
 225 003c DBB2     		uxtb	r3, r3
 226              	.LVL22:
 227              	.L14:
 143:FreeModbus/functions/mbfunccoils_m.c ****         }
 144:FreeModbus/functions/mbfunccoils_m.c ****         else
 145:FreeModbus/functions/mbfunccoils_m.c ****         {
 146:FreeModbus/functions/mbfunccoils_m.c ****         	ucByteCount = ( UCHAR )( usCoilCount / 8 );
 147:FreeModbus/functions/mbfunccoils_m.c ****         }
 148:FreeModbus/functions/mbfunccoils_m.c **** 
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 8


 149:FreeModbus/functions/mbfunccoils_m.c ****         /* Check if the number of registers to read is valid. If not
 150:FreeModbus/functions/mbfunccoils_m.c ****          * return Modbus illegal data value exception. 
 151:FreeModbus/functions/mbfunccoils_m.c ****          */
 152:FreeModbus/functions/mbfunccoils_m.c ****         if( ( usCoilCount >= 1 ) &&
 228              		.loc 1 152 9 is_stmt 1 view .LVU69
 229              		.loc 1 152 11 is_stmt 0 view .LVU70
 230 003e A2B1     		cbz	r2, .L17
 153:FreeModbus/functions/mbfunccoils_m.c ****             ( ucByteCount == pucFrame[MB_PDU_FUNC_READ_COILCNT_OFF] ) )
 231              		.loc 1 153 38 discriminator 1 view .LVU71
 232 0040 6878     		ldrb	r0, [r5, #1]	@ zero_extendqisi2
 152:FreeModbus/functions/mbfunccoils_m.c ****             ( ucByteCount == pucFrame[MB_PDU_FUNC_READ_COILCNT_OFF] ) )
 233              		.loc 1 152 34 discriminator 1 view .LVU72
 234 0042 9842     		cmp	r0, r3
 235 0044 04D0     		beq	.L20
 154:FreeModbus/functions/mbfunccoils_m.c ****         {
 155:FreeModbus/functions/mbfunccoils_m.c ****         	/* Make callback to fill the buffer. */
 156:FreeModbus/functions/mbfunccoils_m.c ****             eRegStatus = eMBMasterRegCoilsCB( &pucFrame[MB_PDU_FUNC_READ_VALUES_OFF], usRegAddress,
 157:FreeModbus/functions/mbfunccoils_m.c **** 
 158:FreeModbus/functions/mbfunccoils_m.c ****             /* If an error occured convert it into a Modbus exception. */
 159:FreeModbus/functions/mbfunccoils_m.c ****             if( eRegStatus != MB_ENOERR )
 160:FreeModbus/functions/mbfunccoils_m.c ****             {
 161:FreeModbus/functions/mbfunccoils_m.c ****                 eStatus = prveMBError2Exception( eRegStatus );
 162:FreeModbus/functions/mbfunccoils_m.c ****             }
 163:FreeModbus/functions/mbfunccoils_m.c ****         }
 164:FreeModbus/functions/mbfunccoils_m.c ****         else
 165:FreeModbus/functions/mbfunccoils_m.c ****         {
 166:FreeModbus/functions/mbfunccoils_m.c ****             eStatus = MB_EX_ILLEGAL_DATA_VALUE;
 236              		.loc 1 166 21 view .LVU73
 237 0046 0320     		movs	r0, #3
 238 0048 0BE0     		b	.L12
 239              	.LVL23:
 240              	.L13:
 146:FreeModbus/functions/mbfunccoils_m.c ****         }
 241              		.loc 1 146 10 is_stmt 1 view .LVU74
 146:FreeModbus/functions/mbfunccoils_m.c ****         }
 242              		.loc 1 146 22 is_stmt 0 view .LVU75
 243 004a C2F3C703 		ubfx	r3, r2, #3, #8
 244              	.LVL24:
 146:FreeModbus/functions/mbfunccoils_m.c ****         }
 245              		.loc 1 146 22 view .LVU76
 246 004e F6E7     		b	.L14
 247              	.L20:
 156:FreeModbus/functions/mbfunccoils_m.c **** 
 248              		.loc 1 156 13 is_stmt 1 view .LVU77
 156:FreeModbus/functions/mbfunccoils_m.c **** 
 249              		.loc 1 156 26 is_stmt 0 view .LVU78
 250 0050 0023     		movs	r3, #0
 251              	.LVL25:
 156:FreeModbus/functions/mbfunccoils_m.c **** 
 252              		.loc 1 156 26 view .LVU79
 253 0052 A81C     		adds	r0, r5, #2
 254 0054 FFF7FEFF 		bl	eMBMasterRegCoilsCB
 255              	.LVL26:
 159:FreeModbus/functions/mbfunccoils_m.c ****             {
 256              		.loc 1 159 13 is_stmt 1 view .LVU80
 159:FreeModbus/functions/mbfunccoils_m.c ****             {
 257              		.loc 1 159 15 is_stmt 0 view .LVU81
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 9


 258 0058 18B1     		cbz	r0, .L12
 161:FreeModbus/functions/mbfunccoils_m.c ****             }
 259              		.loc 1 161 17 is_stmt 1 view .LVU82
 161:FreeModbus/functions/mbfunccoils_m.c ****             }
 260              		.loc 1 161 27 is_stmt 0 view .LVU83
 261 005a FFF7FEFF 		bl	prveMBError2Exception
 262              	.LVL27:
 161:FreeModbus/functions/mbfunccoils_m.c ****             }
 263              		.loc 1 161 27 view .LVU84
 264 005e 00E0     		b	.L12
 265              	.LVL28:
 266              	.L15:
 126:FreeModbus/functions/mbfunccoils_m.c ****     }
 267              		.loc 1 126 14 view .LVU85
 268 0060 0020     		movs	r0, #0
 269              	.LVL29:
 270              	.L12:
 167:FreeModbus/functions/mbfunccoils_m.c ****         }
 168:FreeModbus/functions/mbfunccoils_m.c ****     }
 169:FreeModbus/functions/mbfunccoils_m.c ****     else
 170:FreeModbus/functions/mbfunccoils_m.c ****     {
 171:FreeModbus/functions/mbfunccoils_m.c ****         /* Can't be a valid read coil register request because the length
 172:FreeModbus/functions/mbfunccoils_m.c ****          * is incorrect. */
 173:FreeModbus/functions/mbfunccoils_m.c ****         eStatus = MB_EX_ILLEGAL_DATA_VALUE;
 174:FreeModbus/functions/mbfunccoils_m.c ****     }
 175:FreeModbus/functions/mbfunccoils_m.c ****     return eStatus;
 271              		.loc 1 175 5 is_stmt 1 view .LVU86
 176:FreeModbus/functions/mbfunccoils_m.c **** }
 272              		.loc 1 176 1 is_stmt 0 view .LVU87
 273 0062 03B0     		add	sp, sp, #12
 274              	.LCFI6:
 275              		.cfi_remember_state
 276              		.cfi_def_cfa_offset 12
 277              		@ sp needed
 278 0064 30BD     		pop	{r4, r5, pc}
 279              	.LVL30:
 280              	.L16:
 281              	.LCFI7:
 282              		.cfi_restore_state
 173:FreeModbus/functions/mbfunccoils_m.c ****     }
 283              		.loc 1 173 17 view .LVU88
 284 0066 0320     		movs	r0, #3
 285 0068 FBE7     		b	.L12
 286              	.LVL31:
 287              	.L17:
 166:FreeModbus/functions/mbfunccoils_m.c ****         }
 288              		.loc 1 166 21 view .LVU89
 289 006a 0320     		movs	r0, #3
 290 006c F9E7     		b	.L12
 291              		.cfi_endproc
 292              	.LFE66:
 294              		.section	.text.eMBMasterReqWriteCoil,"ax",%progbits
 295              		.align	1
 296              		.global	eMBMasterReqWriteCoil
 297              		.syntax unified
 298              		.thumb
 299              		.thumb_func
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 10


 301              	eMBMasterReqWriteCoil:
 302              	.LVL32:
 303              	.LFB67:
 177:FreeModbus/functions/mbfunccoils_m.c **** #endif
 178:FreeModbus/functions/mbfunccoils_m.c **** 
 179:FreeModbus/functions/mbfunccoils_m.c **** #if MB_FUNC_WRITE_COIL_ENABLED > 0
 180:FreeModbus/functions/mbfunccoils_m.c **** 
 181:FreeModbus/functions/mbfunccoils_m.c **** /**
 182:FreeModbus/functions/mbfunccoils_m.c ****  * This function will request write one coil.
 183:FreeModbus/functions/mbfunccoils_m.c ****  *
 184:FreeModbus/functions/mbfunccoils_m.c ****  * @param ucSndAddr salve address
 185:FreeModbus/functions/mbfunccoils_m.c ****  * @param usCoilAddr coil start address
 186:FreeModbus/functions/mbfunccoils_m.c ****  * @param usCoilData data to be written
 187:FreeModbus/functions/mbfunccoils_m.c ****  * @param lTimeOut timeout (-1 will waiting forever)
 188:FreeModbus/functions/mbfunccoils_m.c ****  *
 189:FreeModbus/functions/mbfunccoils_m.c ****  * @return error code
 190:FreeModbus/functions/mbfunccoils_m.c ****  *
 191:FreeModbus/functions/mbfunccoils_m.c ****  * @see eMBMasterReqWriteMultipleCoils
 192:FreeModbus/functions/mbfunccoils_m.c ****  */
 193:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterReqErrCode
 194:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterReqWriteCoil( UCHAR ucSndAddr, USHORT usCoilAddr, USHORT usCoilData, LONG lTimeOut )
 195:FreeModbus/functions/mbfunccoils_m.c **** {
 304              		.loc 1 195 1 is_stmt 1 view -0
 305              		.cfi_startproc
 306              		@ args = 0, pretend = 0, frame = 8
 307              		@ frame_needed = 0, uses_anonymous_args = 0
 196:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                 *ucMBFrame;
 308              		.loc 1 196 5 view .LVU91
 197:FreeModbus/functions/mbfunccoils_m.c ****     eMBMasterReqErrCode    eErrStatus = MB_MRE_NO_ERR;
 309              		.loc 1 197 5 view .LVU92
 198:FreeModbus/functions/mbfunccoils_m.c **** 
 199:FreeModbus/functions/mbfunccoils_m.c ****     if ( ucSndAddr > MB_MASTER_TOTAL_SLAVE_NUM ) eErrStatus = MB_MRE_ILL_ARG;
 310              		.loc 1 199 5 view .LVU93
 311              		.loc 1 199 8 is_stmt 0 view .LVU94
 312 0000 1028     		cmp	r0, #16
 313 0002 2CD8     		bhi	.L24
 195:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                 *ucMBFrame;
 314              		.loc 1 195 1 view .LVU95
 315 0004 F0B5     		push	{r4, r5, r6, r7, lr}
 316              	.LCFI8:
 317              		.cfi_def_cfa_offset 20
 318              		.cfi_offset 4, -20
 319              		.cfi_offset 5, -16
 320              		.cfi_offset 6, -12
 321              		.cfi_offset 7, -8
 322              		.cfi_offset 14, -4
 323 0006 83B0     		sub	sp, sp, #12
 324              	.LCFI9:
 325              		.cfi_def_cfa_offset 32
 326 0008 0546     		mov	r5, r0
 327 000a 0F46     		mov	r7, r1
 328 000c 1446     		mov	r4, r2
 329 000e 1E46     		mov	r6, r3
 200:FreeModbus/functions/mbfunccoils_m.c ****     else if ( ( usCoilData != 0xFF00 ) && ( usCoilData != 0x0000 ) ) eErrStatus = MB_MRE_ILL_ARG;
 330              		.loc 1 200 10 is_stmt 1 view .LVU96
 331              		.loc 1 200 13 is_stmt 0 view .LVU97
 332 0010 B2F57F4F 		cmp	r2, #65280
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 11


 333 0014 00D0     		beq	.L23
 334              		.loc 1 200 40 discriminator 1 view .LVU98
 335 0016 22BB     		cbnz	r2, .L25
 336              	.L23:
 201:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 337              		.loc 1 201 10 is_stmt 1 view .LVU99
 338              		.loc 1 201 15 is_stmt 0 view .LVU100
 339 0018 3046     		mov	r0, r6
 340              	.LVL33:
 341              		.loc 1 201 15 view .LVU101
 342 001a FFF7FEFF 		bl	xMBMasterRunResTake
 343              	.LVL34:
 344              		.loc 1 201 13 view .LVU102
 345 001e 10B9     		cbnz	r0, .L31
 346              		.loc 1 201 69 view .LVU103
 347 0020 0520     		movs	r0, #5
 348              	.LVL35:
 349              	.L22:
 202:FreeModbus/functions/mbfunccoils_m.c ****     else
 203:FreeModbus/functions/mbfunccoils_m.c ****     {
 204:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterGetPDUSndBuf(&ucMBFrame);
 205:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetDestAddress(ucSndAddr);
 206:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_FUNC_OFF]                = MB_FUNC_WRITE_SINGLE_COIL;
 207:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_ADDR_OFF]      = usCoilAddr >> 8;
 208:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_ADDR_OFF + 1]  = usCoilAddr;
 209:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF ]    = usCoilData >> 8;
 210:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF + 1] = usCoilData;
 211:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_WRITE_SIZE );
 212:FreeModbus/functions/mbfunccoils_m.c **** 		( void ) xMBMasterPortEventPost( EV_MASTER_FRAME_SENT );
 213:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 214:FreeModbus/functions/mbfunccoils_m.c ****     }
 215:FreeModbus/functions/mbfunccoils_m.c ****     return eErrStatus;
 350              		.loc 1 215 5 is_stmt 1 view .LVU104
 216:FreeModbus/functions/mbfunccoils_m.c **** }
 351              		.loc 1 216 1 is_stmt 0 view .LVU105
 352 0022 03B0     		add	sp, sp, #12
 353              	.LCFI10:
 354              		.cfi_remember_state
 355              		.cfi_def_cfa_offset 20
 356              		@ sp needed
 357 0024 F0BD     		pop	{r4, r5, r6, r7, pc}
 358              	.LVL36:
 359              	.L31:
 360              	.LCFI11:
 361              		.cfi_restore_state
 204:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetDestAddress(ucSndAddr);
 362              		.loc 1 204 3 is_stmt 1 view .LVU106
 363 0026 01A8     		add	r0, sp, #4
 364 0028 FFF7FEFF 		bl	vMBMasterGetPDUSndBuf
 365              	.LVL37:
 205:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_FUNC_OFF]                = MB_FUNC_WRITE_SINGLE_COIL;
 366              		.loc 1 205 3 view .LVU107
 367 002c 2846     		mov	r0, r5
 368 002e FFF7FEFF 		bl	vMBMasterSetDestAddress
 369              	.LVL38:
 206:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_ADDR_OFF]      = usCoilAddr >> 8;
 370              		.loc 1 206 3 view .LVU108
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 12


 206:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_ADDR_OFF]      = usCoilAddr >> 8;
 371              		.loc 1 206 45 is_stmt 0 view .LVU109
 372 0032 0520     		movs	r0, #5
 373 0034 019B     		ldr	r3, [sp, #4]
 374 0036 1870     		strb	r0, [r3]
 207:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_ADDR_OFF + 1]  = usCoilAddr;
 375              		.loc 1 207 3 is_stmt 1 view .LVU110
 207:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_ADDR_OFF + 1]  = usCoilAddr;
 376              		.loc 1 207 45 is_stmt 0 view .LVU111
 377 0038 3A0A     		lsrs	r2, r7, #8
 378 003a 019B     		ldr	r3, [sp, #4]
 379 003c 5A70     		strb	r2, [r3, #1]
 208:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF ]    = usCoilData >> 8;
 380              		.loc 1 208 3 is_stmt 1 view .LVU112
 208:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF ]    = usCoilData >> 8;
 381              		.loc 1 208 12 is_stmt 0 view .LVU113
 382 003e 019B     		ldr	r3, [sp, #4]
 208:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF ]    = usCoilData >> 8;
 383              		.loc 1 208 45 view .LVU114
 384 0040 9F70     		strb	r7, [r3, #2]
 209:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF + 1] = usCoilData;
 385              		.loc 1 209 3 is_stmt 1 view .LVU115
 209:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_VALUE_OFF + 1] = usCoilData;
 386              		.loc 1 209 45 is_stmt 0 view .LVU116
 387 0042 220A     		lsrs	r2, r4, #8
 388 0044 019B     		ldr	r3, [sp, #4]
 389 0046 DA70     		strb	r2, [r3, #3]
 210:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_WRITE_SIZE );
 390              		.loc 1 210 3 is_stmt 1 view .LVU117
 210:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_WRITE_SIZE );
 391              		.loc 1 210 12 is_stmt 0 view .LVU118
 392 0048 019B     		ldr	r3, [sp, #4]
 210:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_WRITE_SIZE );
 393              		.loc 1 210 45 view .LVU119
 394 004a 1C71     		strb	r4, [r3, #4]
 211:FreeModbus/functions/mbfunccoils_m.c **** 		( void ) xMBMasterPortEventPost( EV_MASTER_FRAME_SENT );
 395              		.loc 1 211 3 is_stmt 1 view .LVU120
 396 004c FFF7FEFF 		bl	vMBMasterSetPDUSndLength
 397              	.LVL39:
 212:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 398              		.loc 1 212 3 view .LVU121
 212:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 399              		.loc 1 212 12 is_stmt 0 view .LVU122
 400 0050 0820     		movs	r0, #8
 401 0052 FFF7FEFF 		bl	xMBMasterPortEventPost
 402              	.LVL40:
 213:FreeModbus/functions/mbfunccoils_m.c ****     }
 403              		.loc 1 213 3 is_stmt 1 view .LVU123
 213:FreeModbus/functions/mbfunccoils_m.c ****     }
 404              		.loc 1 213 16 is_stmt 0 view .LVU124
 405 0056 3046     		mov	r0, r6
 406 0058 FFF7FEFF 		bl	eMBMasterWaitRequestFinish
 407              	.LVL41:
 213:FreeModbus/functions/mbfunccoils_m.c ****     }
 408              		.loc 1 213 16 view .LVU125
 409 005c E1E7     		b	.L22
 410              	.LVL42:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 13


 411              	.L24:
 412              	.LCFI12:
 413              		.cfi_def_cfa_offset 0
 414              		.cfi_restore 4
 415              		.cfi_restore 5
 416              		.cfi_restore 6
 417              		.cfi_restore 7
 418              		.cfi_restore 14
 199:FreeModbus/functions/mbfunccoils_m.c ****     else if ( ( usCoilData != 0xFF00 ) && ( usCoilData != 0x0000 ) ) eErrStatus = MB_MRE_ILL_ARG;
 419              		.loc 1 199 61 view .LVU126
 420 005e 0220     		movs	r0, #2
 421              	.LVL43:
 215:FreeModbus/functions/mbfunccoils_m.c **** }
 422              		.loc 1 215 5 is_stmt 1 view .LVU127
 423              		.loc 1 216 1 is_stmt 0 view .LVU128
 424 0060 7047     		bx	lr
 425              	.LVL44:
 426              	.L25:
 427              	.LCFI13:
 428              		.cfi_def_cfa_offset 32
 429              		.cfi_offset 4, -20
 430              		.cfi_offset 5, -16
 431              		.cfi_offset 6, -12
 432              		.cfi_offset 7, -8
 433              		.cfi_offset 14, -4
 200:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 434              		.loc 1 200 81 view .LVU129
 435 0062 0220     		movs	r0, #2
 436              	.LVL45:
 200:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 437              		.loc 1 200 81 view .LVU130
 438 0064 DDE7     		b	.L22
 439              		.cfi_endproc
 440              	.LFE67:
 442              		.section	.text.eMBMasterFuncWriteCoil,"ax",%progbits
 443              		.align	1
 444              		.global	eMBMasterFuncWriteCoil
 445              		.syntax unified
 446              		.thumb
 447              		.thumb_func
 449              	eMBMasterFuncWriteCoil:
 450              	.LVL46:
 451              	.LFB68:
 217:FreeModbus/functions/mbfunccoils_m.c **** 
 218:FreeModbus/functions/mbfunccoils_m.c **** eMBException
 219:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterFuncWriteCoil( UCHAR * pucFrame, USHORT * usLen )
 220:FreeModbus/functions/mbfunccoils_m.c **** {
 452              		.loc 1 220 1 is_stmt 1 view -0
 453              		.cfi_startproc
 454              		@ args = 0, pretend = 0, frame = 8
 455              		@ frame_needed = 0, uses_anonymous_args = 0
 221:FreeModbus/functions/mbfunccoils_m.c ****     USHORT          usRegAddress;
 456              		.loc 1 221 5 view .LVU132
 222:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR           ucBuf[2];
 457              		.loc 1 222 5 view .LVU133
 223:FreeModbus/functions/mbfunccoils_m.c **** 
 224:FreeModbus/functions/mbfunccoils_m.c ****     eMBException    eStatus = MB_EX_NONE;
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 14


 458              		.loc 1 224 5 view .LVU134
 225:FreeModbus/functions/mbfunccoils_m.c ****     eMBErrorCode    eRegStatus;
 459              		.loc 1 225 5 view .LVU135
 226:FreeModbus/functions/mbfunccoils_m.c **** 
 227:FreeModbus/functions/mbfunccoils_m.c ****     if( *usLen == ( MB_PDU_FUNC_WRITE_SIZE + MB_PDU_SIZE_MIN ) )
 460              		.loc 1 227 5 view .LVU136
 461              		.loc 1 227 9 is_stmt 0 view .LVU137
 462 0000 0B88     		ldrh	r3, [r1]
 463              		.loc 1 227 7 view .LVU138
 464 0002 052B     		cmp	r3, #5
 465 0004 01D0     		beq	.L43
 228:FreeModbus/functions/mbfunccoils_m.c ****     {
 229:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress = ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_ADDR_OFF] << 8 );
 230:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress |= ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_ADDR_OFF + 1] );
 231:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress++;
 232:FreeModbus/functions/mbfunccoils_m.c **** 
 233:FreeModbus/functions/mbfunccoils_m.c ****         if( ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF + 1] == 0x00 ) &&
 234:FreeModbus/functions/mbfunccoils_m.c ****             ( ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF ) ||
 235:FreeModbus/functions/mbfunccoils_m.c ****               ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0x00 ) ) )
 236:FreeModbus/functions/mbfunccoils_m.c ****         {
 237:FreeModbus/functions/mbfunccoils_m.c ****             ucBuf[1] = 0;
 238:FreeModbus/functions/mbfunccoils_m.c ****             if( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF )
 239:FreeModbus/functions/mbfunccoils_m.c ****             {
 240:FreeModbus/functions/mbfunccoils_m.c ****                 ucBuf[0] = 1;
 241:FreeModbus/functions/mbfunccoils_m.c ****             }
 242:FreeModbus/functions/mbfunccoils_m.c ****             else
 243:FreeModbus/functions/mbfunccoils_m.c ****             {
 244:FreeModbus/functions/mbfunccoils_m.c ****                 ucBuf[0] = 0;
 245:FreeModbus/functions/mbfunccoils_m.c ****             }
 246:FreeModbus/functions/mbfunccoils_m.c ****             eRegStatus =
 247:FreeModbus/functions/mbfunccoils_m.c ****                 eMBMasterRegCoilsCB( &ucBuf[0], usRegAddress, 1, MB_REG_WRITE );
 248:FreeModbus/functions/mbfunccoils_m.c **** 
 249:FreeModbus/functions/mbfunccoils_m.c ****             /* If an error occured convert it into a Modbus exception. */
 250:FreeModbus/functions/mbfunccoils_m.c ****             if( eRegStatus != MB_ENOERR )
 251:FreeModbus/functions/mbfunccoils_m.c ****             {
 252:FreeModbus/functions/mbfunccoils_m.c ****                 eStatus = prveMBError2Exception( eRegStatus );
 253:FreeModbus/functions/mbfunccoils_m.c ****             }
 254:FreeModbus/functions/mbfunccoils_m.c ****         }
 255:FreeModbus/functions/mbfunccoils_m.c ****         else
 256:FreeModbus/functions/mbfunccoils_m.c ****         {
 257:FreeModbus/functions/mbfunccoils_m.c ****             eStatus = MB_EX_ILLEGAL_DATA_VALUE;
 258:FreeModbus/functions/mbfunccoils_m.c ****         }
 259:FreeModbus/functions/mbfunccoils_m.c ****     }
 260:FreeModbus/functions/mbfunccoils_m.c ****     else
 261:FreeModbus/functions/mbfunccoils_m.c ****     {
 262:FreeModbus/functions/mbfunccoils_m.c ****         /* Can't be a valid write coil register request because the length
 263:FreeModbus/functions/mbfunccoils_m.c ****          * is incorrect. */
 264:FreeModbus/functions/mbfunccoils_m.c ****         eStatus = MB_EX_ILLEGAL_DATA_VALUE;
 466              		.loc 1 264 17 view .LVU139
 467 0006 0320     		movs	r0, #3
 468              	.LVL47:
 469              		.loc 1 264 17 view .LVU140
 470 0008 7047     		bx	lr
 471              	.LVL48:
 472              	.L43:
 229:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress |= ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_ADDR_OFF + 1] );
 473              		.loc 1 229 9 is_stmt 1 view .LVU141
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 15


 229:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress |= ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_ADDR_OFF + 1] );
 474              		.loc 1 229 44 is_stmt 0 view .LVU142
 475 000a 4378     		ldrb	r3, [r0, #1]	@ zero_extendqisi2
 476              	.LVL49:
 230:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress++;
 477              		.loc 1 230 9 is_stmt 1 view .LVU143
 230:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress++;
 478              		.loc 1 230 45 is_stmt 0 view .LVU144
 479 000c 8178     		ldrb	r1, [r0, #2]	@ zero_extendqisi2
 480              	.LVL50:
 230:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress++;
 481              		.loc 1 230 22 view .LVU145
 482 000e 41EA0321 		orr	r1, r1, r3, lsl #8
 483              	.LVL51:
 231:FreeModbus/functions/mbfunccoils_m.c **** 
 484              		.loc 1 231 9 is_stmt 1 view .LVU146
 231:FreeModbus/functions/mbfunccoils_m.c **** 
 485              		.loc 1 231 21 is_stmt 0 view .LVU147
 486 0012 0131     		adds	r1, r1, #1
 487              	.LVL52:
 231:FreeModbus/functions/mbfunccoils_m.c **** 
 488              		.loc 1 231 21 view .LVU148
 489 0014 89B2     		uxth	r1, r1
 490              	.LVL53:
 233:FreeModbus/functions/mbfunccoils_m.c ****             ( ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF ) ||
 491              		.loc 1 233 9 is_stmt 1 view .LVU149
 233:FreeModbus/functions/mbfunccoils_m.c ****             ( ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF ) ||
 492              		.loc 1 233 23 is_stmt 0 view .LVU150
 493 0016 0379     		ldrb	r3, [r0, #4]	@ zero_extendqisi2
 233:FreeModbus/functions/mbfunccoils_m.c ****             ( ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF ) ||
 494              		.loc 1 233 11 view .LVU151
 495 0018 F3B9     		cbnz	r3, .L37
 234:FreeModbus/functions/mbfunccoils_m.c ****               ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0x00 ) ) )
 496              		.loc 1 234 25 discriminator 1 view .LVU152
 497 001a C278     		ldrb	r2, [r0, #3]	@ zero_extendqisi2
 234:FreeModbus/functions/mbfunccoils_m.c ****               ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0x00 ) ) )
 498              		.loc 1 234 65 discriminator 1 view .LVU153
 499 001c 531E     		subs	r3, r2, #1
 500 001e DBB2     		uxtb	r3, r3
 233:FreeModbus/functions/mbfunccoils_m.c ****             ( ( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF ) ||
 501              		.loc 1 233 67 discriminator 1 view .LVU154
 502 0020 FD2B     		cmp	r3, #253
 503 0022 1BD9     		bls	.L38
 220:FreeModbus/functions/mbfunccoils_m.c ****     USHORT          usRegAddress;
 504              		.loc 1 220 1 view .LVU155
 505 0024 00B5     		push	{lr}
 506              	.LCFI14:
 507              		.cfi_def_cfa_offset 4
 508              		.cfi_offset 14, -4
 509 0026 83B0     		sub	sp, sp, #12
 510              	.LCFI15:
 511              		.cfi_def_cfa_offset 16
 237:FreeModbus/functions/mbfunccoils_m.c ****             if( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF )
 512              		.loc 1 237 13 is_stmt 1 view .LVU156
 237:FreeModbus/functions/mbfunccoils_m.c ****             if( pucFrame[MB_PDU_FUNC_WRITE_VALUE_OFF] == 0xFF )
 513              		.loc 1 237 22 is_stmt 0 view .LVU157
 514 0028 0023     		movs	r3, #0
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 16


 515 002a 8DF80530 		strb	r3, [sp, #5]
 238:FreeModbus/functions/mbfunccoils_m.c ****             {
 516              		.loc 1 238 13 is_stmt 1 view .LVU158
 238:FreeModbus/functions/mbfunccoils_m.c ****             {
 517              		.loc 1 238 15 is_stmt 0 view .LVU159
 518 002e FF2A     		cmp	r2, #255
 519 0030 0BD0     		beq	.L44
 244:FreeModbus/functions/mbfunccoils_m.c ****             }
 520              		.loc 1 244 17 is_stmt 1 view .LVU160
 244:FreeModbus/functions/mbfunccoils_m.c ****             }
 521              		.loc 1 244 26 is_stmt 0 view .LVU161
 522 0032 0023     		movs	r3, #0
 523 0034 8DF80430 		strb	r3, [sp, #4]
 524              	.L35:
 246:FreeModbus/functions/mbfunccoils_m.c ****                 eMBMasterRegCoilsCB( &ucBuf[0], usRegAddress, 1, MB_REG_WRITE );
 525              		.loc 1 246 13 is_stmt 1 view .LVU162
 247:FreeModbus/functions/mbfunccoils_m.c **** 
 526              		.loc 1 247 17 is_stmt 0 view .LVU163
 527 0038 0123     		movs	r3, #1
 528 003a 1A46     		mov	r2, r3
 529 003c 01A8     		add	r0, sp, #4
 530              	.LVL54:
 247:FreeModbus/functions/mbfunccoils_m.c **** 
 531              		.loc 1 247 17 view .LVU164
 532 003e FFF7FEFF 		bl	eMBMasterRegCoilsCB
 533              	.LVL55:
 250:FreeModbus/functions/mbfunccoils_m.c ****             {
 534              		.loc 1 250 13 is_stmt 1 view .LVU165
 250:FreeModbus/functions/mbfunccoils_m.c ****             {
 535              		.loc 1 250 15 is_stmt 0 view .LVU166
 536 0042 30B9     		cbnz	r0, .L45
 537              	.LVL56:
 538              	.L33:
 265:FreeModbus/functions/mbfunccoils_m.c ****     }
 266:FreeModbus/functions/mbfunccoils_m.c ****     return eStatus;
 539              		.loc 1 266 5 is_stmt 1 view .LVU167
 267:FreeModbus/functions/mbfunccoils_m.c **** }
 540              		.loc 1 267 1 is_stmt 0 view .LVU168
 541 0044 03B0     		add	sp, sp, #12
 542              	.LCFI16:
 543              		.cfi_remember_state
 544              		.cfi_def_cfa_offset 4
 545              		@ sp needed
 546 0046 5DF804FB 		ldr	pc, [sp], #4
 547              	.LVL57:
 548              	.L44:
 549              	.LCFI17:
 550              		.cfi_restore_state
 240:FreeModbus/functions/mbfunccoils_m.c ****             }
 551              		.loc 1 240 17 is_stmt 1 view .LVU169
 240:FreeModbus/functions/mbfunccoils_m.c ****             }
 552              		.loc 1 240 26 is_stmt 0 view .LVU170
 553 004a 0123     		movs	r3, #1
 554 004c 8DF80430 		strb	r3, [sp, #4]
 555 0050 F2E7     		b	.L35
 556              	.LVL58:
 557              	.L45:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 17


 252:FreeModbus/functions/mbfunccoils_m.c ****             }
 558              		.loc 1 252 17 is_stmt 1 view .LVU171
 252:FreeModbus/functions/mbfunccoils_m.c ****             }
 559              		.loc 1 252 27 is_stmt 0 view .LVU172
 560 0052 FFF7FEFF 		bl	prveMBError2Exception
 561              	.LVL59:
 252:FreeModbus/functions/mbfunccoils_m.c ****             }
 562              		.loc 1 252 27 view .LVU173
 563 0056 F5E7     		b	.L33
 564              	.LVL60:
 565              	.L37:
 566              	.LCFI18:
 567              		.cfi_def_cfa_offset 0
 568              		.cfi_restore 14
 257:FreeModbus/functions/mbfunccoils_m.c ****         }
 569              		.loc 1 257 21 view .LVU174
 570 0058 0320     		movs	r0, #3
 571              	.LVL61:
 257:FreeModbus/functions/mbfunccoils_m.c ****         }
 572              		.loc 1 257 21 view .LVU175
 573 005a 7047     		bx	lr
 574              	.LVL62:
 575              	.L38:
 257:FreeModbus/functions/mbfunccoils_m.c ****         }
 576              		.loc 1 257 21 view .LVU176
 577 005c 0320     		movs	r0, #3
 578              	.LVL63:
 266:FreeModbus/functions/mbfunccoils_m.c **** }
 579              		.loc 1 266 5 is_stmt 1 view .LVU177
 580              		.loc 1 267 1 is_stmt 0 view .LVU178
 581 005e 7047     		bx	lr
 582              		.cfi_endproc
 583              	.LFE68:
 585              		.section	.text.eMBMasterReqWriteMultipleCoils,"ax",%progbits
 586              		.align	1
 587              		.global	eMBMasterReqWriteMultipleCoils
 588              		.syntax unified
 589              		.thumb
 590              		.thumb_func
 592              	eMBMasterReqWriteMultipleCoils:
 593              	.LVL64:
 594              	.LFB69:
 268:FreeModbus/functions/mbfunccoils_m.c **** 
 269:FreeModbus/functions/mbfunccoils_m.c **** #endif
 270:FreeModbus/functions/mbfunccoils_m.c **** 
 271:FreeModbus/functions/mbfunccoils_m.c **** #if MB_FUNC_WRITE_MULTIPLE_COILS_ENABLED > 0
 272:FreeModbus/functions/mbfunccoils_m.c **** 
 273:FreeModbus/functions/mbfunccoils_m.c **** /**
 274:FreeModbus/functions/mbfunccoils_m.c ****  * This function will request write multiple coils.
 275:FreeModbus/functions/mbfunccoils_m.c ****  *
 276:FreeModbus/functions/mbfunccoils_m.c ****  * @param ucSndAddr salve address
 277:FreeModbus/functions/mbfunccoils_m.c ****  * @param usCoilAddr coil start address
 278:FreeModbus/functions/mbfunccoils_m.c ****  * @param usNCoils coil total number
 279:FreeModbus/functions/mbfunccoils_m.c ****  * @param usCoilData data to be written
 280:FreeModbus/functions/mbfunccoils_m.c ****  * @param lTimeOut timeout (-1 will waiting forever)
 281:FreeModbus/functions/mbfunccoils_m.c ****  *
 282:FreeModbus/functions/mbfunccoils_m.c ****  * @return error code
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 18


 283:FreeModbus/functions/mbfunccoils_m.c ****  *
 284:FreeModbus/functions/mbfunccoils_m.c ****  * @see eMBMasterReqWriteCoil
 285:FreeModbus/functions/mbfunccoils_m.c ****  */
 286:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterReqErrCode
 287:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterReqWriteMultipleCoils( UCHAR ucSndAddr,
 288:FreeModbus/functions/mbfunccoils_m.c **** 		USHORT usCoilAddr, USHORT usNCoils, UCHAR * pucDataBuffer, LONG lTimeOut)
 289:FreeModbus/functions/mbfunccoils_m.c **** {
 595              		.loc 1 289 1 is_stmt 1 view -0
 596              		.cfi_startproc
 597              		@ args = 4, pretend = 0, frame = 8
 598              		@ frame_needed = 0, uses_anonymous_args = 0
 290:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                 *ucMBFrame;
 599              		.loc 1 290 5 view .LVU180
 291:FreeModbus/functions/mbfunccoils_m.c ****     USHORT                 usRegIndex = 0;
 600              		.loc 1 291 5 view .LVU181
 292:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                  ucByteCount;
 601              		.loc 1 292 5 view .LVU182
 293:FreeModbus/functions/mbfunccoils_m.c ****     eMBMasterReqErrCode    eErrStatus = MB_MRE_NO_ERR;
 602              		.loc 1 293 5 view .LVU183
 294:FreeModbus/functions/mbfunccoils_m.c **** 
 295:FreeModbus/functions/mbfunccoils_m.c ****     if ( ucSndAddr > MB_MASTER_TOTAL_SLAVE_NUM ) eErrStatus = MB_MRE_ILL_ARG;
 603              		.loc 1 295 5 view .LVU184
 604              		.loc 1 295 8 is_stmt 0 view .LVU185
 605 0000 1028     		cmp	r0, #16
 606 0002 47D8     		bhi	.L52
 289:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                 *ucMBFrame;
 607              		.loc 1 289 1 view .LVU186
 608 0004 F0B5     		push	{r4, r5, r6, r7, lr}
 609              	.LCFI19:
 610              		.cfi_def_cfa_offset 20
 611              		.cfi_offset 4, -20
 612              		.cfi_offset 5, -16
 613              		.cfi_offset 6, -12
 614              		.cfi_offset 7, -8
 615              		.cfi_offset 14, -4
 616 0006 83B0     		sub	sp, sp, #12
 617              	.LCFI20:
 618              		.cfi_def_cfa_offset 32
 619 0008 0646     		mov	r6, r0
 620 000a 0F46     		mov	r7, r1
 621 000c 1446     		mov	r4, r2
 622 000e 1D46     		mov	r5, r3
 296:FreeModbus/functions/mbfunccoils_m.c ****     else if ( usNCoils > MB_PDU_REQ_WRITE_MUL_COILCNT_MAX ) eErrStatus = MB_MRE_ILL_ARG;
 623              		.loc 1 296 10 is_stmt 1 view .LVU187
 624              		.loc 1 296 13 is_stmt 0 view .LVU188
 625 0010 B2F5F66F 		cmp	r2, #1968
 626 0014 02D9     		bls	.L59
 627              		.loc 1 296 72 view .LVU189
 628 0016 0220     		movs	r0, #2
 629              	.LVL65:
 630              	.L47:
 297:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 298:FreeModbus/functions/mbfunccoils_m.c ****     else
 299:FreeModbus/functions/mbfunccoils_m.c ****     {
 300:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterGetPDUSndBuf(&ucMBFrame);
 301:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetDestAddress(ucSndAddr);
 302:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_FUNC_OFF]                      = MB_FUNC_WRITE_MULTIPLE_COILS;
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 19


 303:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_ADDR_OFF]        = usCoilAddr >> 8;
 304:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_ADDR_OFF + 1]    = usCoilAddr;
 305:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF]     = usNCoils >> 8;
 306:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF + 1] = usNCoils ;
 307:FreeModbus/functions/mbfunccoils_m.c **** 		if( ( usNCoils & 0x0007 ) != 0 )
 308:FreeModbus/functions/mbfunccoils_m.c ****         {
 309:FreeModbus/functions/mbfunccoils_m.c **** 			ucByteCount = ( UCHAR )( usNCoils / 8 + 1 );
 310:FreeModbus/functions/mbfunccoils_m.c ****         }
 311:FreeModbus/functions/mbfunccoils_m.c ****         else
 312:FreeModbus/functions/mbfunccoils_m.c ****         {
 313:FreeModbus/functions/mbfunccoils_m.c ****         	ucByteCount = ( UCHAR )( usNCoils / 8 );
 314:FreeModbus/functions/mbfunccoils_m.c ****         }
 315:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_BYTECNT_OFF]     = ucByteCount;
 316:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame += MB_PDU_REQ_WRITE_MUL_VALUES_OFF;
 317:FreeModbus/functions/mbfunccoils_m.c **** 		while( ucByteCount > usRegIndex)
 318:FreeModbus/functions/mbfunccoils_m.c **** 		{
 319:FreeModbus/functions/mbfunccoils_m.c **** 			*ucMBFrame++ = pucDataBuffer[usRegIndex++];
 320:FreeModbus/functions/mbfunccoils_m.c **** 		}
 321:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetPDUSndLength( MB_PDU_SIZE_MIN + MB_PDU_REQ_WRITE_MUL_SIZE_MIN + ucByteCount );
 322:FreeModbus/functions/mbfunccoils_m.c **** 		( void ) xMBMasterPortEventPost( EV_MASTER_FRAME_SENT );
 323:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 324:FreeModbus/functions/mbfunccoils_m.c ****     }
 325:FreeModbus/functions/mbfunccoils_m.c ****     return eErrStatus;
 631              		.loc 1 325 5 is_stmt 1 view .LVU190
 326:FreeModbus/functions/mbfunccoils_m.c **** }
 632              		.loc 1 326 1 is_stmt 0 view .LVU191
 633 0018 03B0     		add	sp, sp, #12
 634              	.LCFI21:
 635              		.cfi_remember_state
 636              		.cfi_def_cfa_offset 20
 637              		@ sp needed
 638 001a F0BD     		pop	{r4, r5, r6, r7, pc}
 639              	.LVL66:
 640              	.L59:
 641              	.LCFI22:
 642              		.cfi_restore_state
 297:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 643              		.loc 1 297 10 is_stmt 1 view .LVU192
 297:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 644              		.loc 1 297 15 is_stmt 0 view .LVU193
 645 001c 0898     		ldr	r0, [sp, #32]
 646              	.LVL67:
 297:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 647              		.loc 1 297 15 view .LVU194
 648 001e FFF7FEFF 		bl	xMBMasterRunResTake
 649              	.LVL68:
 297:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 650              		.loc 1 297 13 view .LVU195
 651 0022 08B9     		cbnz	r0, .L60
 297:FreeModbus/functions/mbfunccoils_m.c ****     else if ( xMBMasterRunResTake( lTimeOut ) == FALSE ) eErrStatus = MB_MRE_MASTER_BUSY;
 652              		.loc 1 297 69 view .LVU196
 653 0024 0520     		movs	r0, #5
 654 0026 F7E7     		b	.L47
 655              	.L60:
 300:FreeModbus/functions/mbfunccoils_m.c **** 		vMBMasterSetDestAddress(ucSndAddr);
 656              		.loc 1 300 3 is_stmt 1 view .LVU197
 657 0028 01A8     		add	r0, sp, #4
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 20


 658 002a FFF7FEFF 		bl	vMBMasterGetPDUSndBuf
 659              	.LVL69:
 301:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_FUNC_OFF]                      = MB_FUNC_WRITE_MULTIPLE_COILS;
 660              		.loc 1 301 3 view .LVU198
 661 002e 3046     		mov	r0, r6
 662 0030 FFF7FEFF 		bl	vMBMasterSetDestAddress
 663              	.LVL70:
 302:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_ADDR_OFF]        = usCoilAddr >> 8;
 664              		.loc 1 302 3 view .LVU199
 302:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_ADDR_OFF]        = usCoilAddr >> 8;
 665              		.loc 1 302 51 is_stmt 0 view .LVU200
 666 0034 019B     		ldr	r3, [sp, #4]
 667 0036 0F22     		movs	r2, #15
 668 0038 1A70     		strb	r2, [r3]
 303:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_ADDR_OFF + 1]    = usCoilAddr;
 669              		.loc 1 303 3 is_stmt 1 view .LVU201
 303:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_ADDR_OFF + 1]    = usCoilAddr;
 670              		.loc 1 303 51 is_stmt 0 view .LVU202
 671 003a 3A0A     		lsrs	r2, r7, #8
 672 003c 019B     		ldr	r3, [sp, #4]
 673 003e 5A70     		strb	r2, [r3, #1]
 304:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF]     = usNCoils >> 8;
 674              		.loc 1 304 3 is_stmt 1 view .LVU203
 304:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF]     = usNCoils >> 8;
 675              		.loc 1 304 12 is_stmt 0 view .LVU204
 676 0040 019B     		ldr	r3, [sp, #4]
 304:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF]     = usNCoils >> 8;
 677              		.loc 1 304 51 view .LVU205
 678 0042 9F70     		strb	r7, [r3, #2]
 305:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF + 1] = usNCoils ;
 679              		.loc 1 305 3 is_stmt 1 view .LVU206
 305:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame[MB_PDU_REQ_WRITE_MUL_COILCNT_OFF + 1] = usNCoils ;
 680              		.loc 1 305 51 is_stmt 0 view .LVU207
 681 0044 230A     		lsrs	r3, r4, #8
 682 0046 019A     		ldr	r2, [sp, #4]
 683 0048 D370     		strb	r3, [r2, #3]
 306:FreeModbus/functions/mbfunccoils_m.c **** 		if( ( usNCoils & 0x0007 ) != 0 )
 684              		.loc 1 306 3 is_stmt 1 view .LVU208
 306:FreeModbus/functions/mbfunccoils_m.c **** 		if( ( usNCoils & 0x0007 ) != 0 )
 685              		.loc 1 306 12 is_stmt 0 view .LVU209
 686 004a 019B     		ldr	r3, [sp, #4]
 306:FreeModbus/functions/mbfunccoils_m.c **** 		if( ( usNCoils & 0x0007 ) != 0 )
 687              		.loc 1 306 51 view .LVU210
 688 004c 1C71     		strb	r4, [r3, #4]
 307:FreeModbus/functions/mbfunccoils_m.c ****         {
 689              		.loc 1 307 3 is_stmt 1 view .LVU211
 307:FreeModbus/functions/mbfunccoils_m.c ****         {
 690              		.loc 1 307 5 is_stmt 0 view .LVU212
 691 004e 14F0070F 		tst	r4, #7
 692 0052 08D0     		beq	.L48
 309:FreeModbus/functions/mbfunccoils_m.c ****         }
 693              		.loc 1 309 4 is_stmt 1 view .LVU213
 309:FreeModbus/functions/mbfunccoils_m.c ****         }
 694              		.loc 1 309 18 is_stmt 0 view .LVU214
 695 0054 C4F3C704 		ubfx	r4, r4, #3, #8
 309:FreeModbus/functions/mbfunccoils_m.c ****         }
 696              		.loc 1 309 16 view .LVU215
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 21


 697 0058 0134     		adds	r4, r4, #1
 698 005a E4B2     		uxtb	r4, r4
 699              	.LVL71:
 700              	.L49:
 315:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame += MB_PDU_REQ_WRITE_MUL_VALUES_OFF;
 701              		.loc 1 315 3 is_stmt 1 view .LVU216
 315:FreeModbus/functions/mbfunccoils_m.c **** 		ucMBFrame += MB_PDU_REQ_WRITE_MUL_VALUES_OFF;
 702              		.loc 1 315 51 is_stmt 0 view .LVU217
 703 005c 5C71     		strb	r4, [r3, #5]
 316:FreeModbus/functions/mbfunccoils_m.c **** 		while( ucByteCount > usRegIndex)
 704              		.loc 1 316 3 is_stmt 1 view .LVU218
 316:FreeModbus/functions/mbfunccoils_m.c **** 		while( ucByteCount > usRegIndex)
 705              		.loc 1 316 13 is_stmt 0 view .LVU219
 706 005e 0633     		adds	r3, r3, #6
 707 0060 0193     		str	r3, [sp, #4]
 317:FreeModbus/functions/mbfunccoils_m.c **** 		{
 708              		.loc 1 317 3 is_stmt 1 view .LVU220
 291:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR                  ucByteCount;
 709              		.loc 1 291 28 is_stmt 0 view .LVU221
 710 0062 0021     		movs	r1, #0
 317:FreeModbus/functions/mbfunccoils_m.c **** 		{
 711              		.loc 1 317 8 view .LVU222
 712 0064 09E0     		b	.L50
 713              	.LVL72:
 714              	.L48:
 313:FreeModbus/functions/mbfunccoils_m.c ****         }
 715              		.loc 1 313 10 is_stmt 1 view .LVU223
 313:FreeModbus/functions/mbfunccoils_m.c ****         }
 716              		.loc 1 313 22 is_stmt 0 view .LVU224
 717 0066 C4F3C704 		ubfx	r4, r4, #3, #8
 718              	.LVL73:
 313:FreeModbus/functions/mbfunccoils_m.c ****         }
 719              		.loc 1 313 22 view .LVU225
 720 006a F7E7     		b	.L49
 721              	.LVL74:
 722              	.L51:
 319:FreeModbus/functions/mbfunccoils_m.c **** 		}
 723              		.loc 1 319 4 is_stmt 1 view .LVU226
 319:FreeModbus/functions/mbfunccoils_m.c **** 		}
 724              		.loc 1 319 43 is_stmt 0 view .LVU227
 725 006c 4A1C     		adds	r2, r1, #1
 726              	.LVL75:
 319:FreeModbus/functions/mbfunccoils_m.c **** 		}
 727              		.loc 1 319 14 view .LVU228
 728 006e 019B     		ldr	r3, [sp, #4]
 729 0070 581C     		adds	r0, r3, #1
 730 0072 0190     		str	r0, [sp, #4]
 319:FreeModbus/functions/mbfunccoils_m.c **** 		}
 731              		.loc 1 319 32 view .LVU229
 732 0074 695C     		ldrb	r1, [r5, r1]	@ zero_extendqisi2
 319:FreeModbus/functions/mbfunccoils_m.c **** 		}
 733              		.loc 1 319 17 view .LVU230
 734 0076 1970     		strb	r1, [r3]
 319:FreeModbus/functions/mbfunccoils_m.c **** 		}
 735              		.loc 1 319 43 view .LVU231
 736 0078 91B2     		uxth	r1, r2
 737              	.LVL76:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 22


 738              	.L50:
 317:FreeModbus/functions/mbfunccoils_m.c **** 		{
 739              		.loc 1 317 8 is_stmt 1 view .LVU232
 317:FreeModbus/functions/mbfunccoils_m.c **** 		{
 740              		.loc 1 317 22 is_stmt 0 view .LVU233
 741 007a A0B2     		uxth	r0, r4
 317:FreeModbus/functions/mbfunccoils_m.c **** 		{
 742              		.loc 1 317 8 view .LVU234
 743 007c 8842     		cmp	r0, r1
 744 007e F5D8     		bhi	.L51
 321:FreeModbus/functions/mbfunccoils_m.c **** 		( void ) xMBMasterPortEventPost( EV_MASTER_FRAME_SENT );
 745              		.loc 1 321 3 is_stmt 1 view .LVU235
 746 0080 0630     		adds	r0, r0, #6
 747 0082 FFF7FEFF 		bl	vMBMasterSetPDUSndLength
 748              	.LVL77:
 322:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 749              		.loc 1 322 3 view .LVU236
 322:FreeModbus/functions/mbfunccoils_m.c **** 		eErrStatus = eMBMasterWaitRequestFinish( lTimeOut );
 750              		.loc 1 322 12 is_stmt 0 view .LVU237
 751 0086 0820     		movs	r0, #8
 752 0088 FFF7FEFF 		bl	xMBMasterPortEventPost
 753              	.LVL78:
 323:FreeModbus/functions/mbfunccoils_m.c ****     }
 754              		.loc 1 323 3 is_stmt 1 view .LVU238
 323:FreeModbus/functions/mbfunccoils_m.c ****     }
 755              		.loc 1 323 16 is_stmt 0 view .LVU239
 756 008c 0898     		ldr	r0, [sp, #32]
 757 008e FFF7FEFF 		bl	eMBMasterWaitRequestFinish
 758              	.LVL79:
 323:FreeModbus/functions/mbfunccoils_m.c ****     }
 759              		.loc 1 323 16 view .LVU240
 760 0092 C1E7     		b	.L47
 761              	.LVL80:
 762              	.L52:
 763              	.LCFI23:
 764              		.cfi_def_cfa_offset 0
 765              		.cfi_restore 4
 766              		.cfi_restore 5
 767              		.cfi_restore 6
 768              		.cfi_restore 7
 769              		.cfi_restore 14
 295:FreeModbus/functions/mbfunccoils_m.c ****     else if ( usNCoils > MB_PDU_REQ_WRITE_MUL_COILCNT_MAX ) eErrStatus = MB_MRE_ILL_ARG;
 770              		.loc 1 295 61 view .LVU241
 771 0094 0220     		movs	r0, #2
 772              	.LVL81:
 325:FreeModbus/functions/mbfunccoils_m.c **** }
 773              		.loc 1 325 5 is_stmt 1 view .LVU242
 774              		.loc 1 326 1 is_stmt 0 view .LVU243
 775 0096 7047     		bx	lr
 776              		.cfi_endproc
 777              	.LFE69:
 779              		.section	.text.eMBMasterFuncWriteMultipleCoils,"ax",%progbits
 780              		.align	1
 781              		.global	eMBMasterFuncWriteMultipleCoils
 782              		.syntax unified
 783              		.thumb
 784              		.thumb_func
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 23


 786              	eMBMasterFuncWriteMultipleCoils:
 787              	.LVL82:
 788              	.LFB70:
 327:FreeModbus/functions/mbfunccoils_m.c **** 
 328:FreeModbus/functions/mbfunccoils_m.c **** eMBException
 329:FreeModbus/functions/mbfunccoils_m.c **** eMBMasterFuncWriteMultipleCoils( UCHAR * pucFrame, USHORT * usLen )
 330:FreeModbus/functions/mbfunccoils_m.c **** {
 789              		.loc 1 330 1 is_stmt 1 view -0
 790              		.cfi_startproc
 791              		@ args = 0, pretend = 0, frame = 8
 792              		@ frame_needed = 0, uses_anonymous_args = 0
 793              		.loc 1 330 1 is_stmt 0 view .LVU245
 794 0000 10B5     		push	{r4, lr}
 795              	.LCFI24:
 796              		.cfi_def_cfa_offset 8
 797              		.cfi_offset 4, -8
 798              		.cfi_offset 14, -4
 799 0002 82B0     		sub	sp, sp, #8
 800              	.LCFI25:
 801              		.cfi_def_cfa_offset 16
 802 0004 0446     		mov	r4, r0
 331:FreeModbus/functions/mbfunccoils_m.c ****     USHORT          usRegAddress;
 803              		.loc 1 331 5 is_stmt 1 view .LVU246
 332:FreeModbus/functions/mbfunccoils_m.c ****     USHORT          usCoilCnt;
 804              		.loc 1 332 5 view .LVU247
 333:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR           ucByteCount;
 805              		.loc 1 333 5 view .LVU248
 334:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR           ucByteCountVerify;
 806              		.loc 1 334 5 view .LVU249
 335:FreeModbus/functions/mbfunccoils_m.c ****     UCHAR          *ucMBFrame;
 807              		.loc 1 335 5 view .LVU250
 336:FreeModbus/functions/mbfunccoils_m.c **** 
 337:FreeModbus/functions/mbfunccoils_m.c ****     eMBException    eStatus = MB_EX_NONE;
 808              		.loc 1 337 5 view .LVU251
 809              	.LVL83:
 338:FreeModbus/functions/mbfunccoils_m.c ****     eMBErrorCode    eRegStatus;
 810              		.loc 1 338 5 view .LVU252
 339:FreeModbus/functions/mbfunccoils_m.c **** 
 340:FreeModbus/functions/mbfunccoils_m.c ****     /* If this request is broadcast, the *usLen is not need check. */
 341:FreeModbus/functions/mbfunccoils_m.c ****     if( ( *usLen == MB_PDU_FUNC_WRITE_MUL_SIZE ) || xMBMasterRequestIsBroadcast() )
 811              		.loc 1 341 5 view .LVU253
 812              		.loc 1 341 11 is_stmt 0 view .LVU254
 813 0006 0B88     		ldrh	r3, [r1]
 814              		.loc 1 341 7 view .LVU255
 815 0008 052B     		cmp	r3, #5
 816 000a 02D0     		beq	.L62
 817              		.loc 1 341 53 discriminator 1 view .LVU256
 818 000c FFF7FEFF 		bl	xMBMasterRequestIsBroadcast
 819              	.LVL84:
 820              		.loc 1 341 50 discriminator 1 view .LVU257
 821 0010 38B3     		cbz	r0, .L66
 822              	.L62:
 342:FreeModbus/functions/mbfunccoils_m.c ****     {
 343:FreeModbus/functions/mbfunccoils_m.c ****     	vMBMasterGetPDUSndBuf(&ucMBFrame);
 823              		.loc 1 343 6 is_stmt 1 view .LVU258
 824 0012 01A8     		add	r0, sp, #4
 825 0014 FFF7FEFF 		bl	vMBMasterGetPDUSndBuf
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 24


 826              	.LVL85:
 344:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress = ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_MUL_ADDR_OFF] << 8 );
 827              		.loc 1 344 9 view .LVU259
 828              		.loc 1 344 44 is_stmt 0 view .LVU260
 829 0018 6378     		ldrb	r3, [r4, #1]	@ zero_extendqisi2
 830              	.LVL86:
 345:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress |= ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_MUL_ADDR_OFF + 1] );
 831              		.loc 1 345 9 is_stmt 1 view .LVU261
 832              		.loc 1 345 45 is_stmt 0 view .LVU262
 833 001a A178     		ldrb	r1, [r4, #2]	@ zero_extendqisi2
 834              		.loc 1 345 22 view .LVU263
 835 001c 41EA0321 		orr	r1, r1, r3, lsl #8
 836              	.LVL87:
 346:FreeModbus/functions/mbfunccoils_m.c ****         usRegAddress++;
 837              		.loc 1 346 9 is_stmt 1 view .LVU264
 838              		.loc 1 346 21 is_stmt 0 view .LVU265
 839 0020 0131     		adds	r1, r1, #1
 840              	.LVL88:
 841              		.loc 1 346 21 view .LVU266
 842 0022 89B2     		uxth	r1, r1
 843              	.LVL89:
 347:FreeModbus/functions/mbfunccoils_m.c **** 
 348:FreeModbus/functions/mbfunccoils_m.c ****         usCoilCnt = ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_MUL_COILCNT_OFF] << 8 );
 844              		.loc 1 348 9 is_stmt 1 view .LVU267
 845              		.loc 1 348 41 is_stmt 0 view .LVU268
 846 0024 E278     		ldrb	r2, [r4, #3]	@ zero_extendqisi2
 847              	.LVL90:
 349:FreeModbus/functions/mbfunccoils_m.c ****         usCoilCnt |= ( USHORT )( pucFrame[MB_PDU_FUNC_WRITE_MUL_COILCNT_OFF + 1] );
 848              		.loc 1 349 9 is_stmt 1 view .LVU269
 849              		.loc 1 349 42 is_stmt 0 view .LVU270
 850 0026 2379     		ldrb	r3, [r4, #4]	@ zero_extendqisi2
 851              		.loc 1 349 19 view .LVU271
 852 0028 43EA0222 		orr	r2, r3, r2, lsl #8
 853              	.LVL91:
 350:FreeModbus/functions/mbfunccoils_m.c **** 
 351:FreeModbus/functions/mbfunccoils_m.c ****         ucByteCount = ucMBFrame[MB_PDU_REQ_WRITE_MUL_BYTECNT_OFF];
 854              		.loc 1 351 9 is_stmt 1 view .LVU272
 855              		.loc 1 351 21 is_stmt 0 view .LVU273
 856 002c 0198     		ldr	r0, [sp, #4]
 857 002e 4479     		ldrb	r4, [r0, #5]	@ zero_extendqisi2
 858              	.LVL92:
 352:FreeModbus/functions/mbfunccoils_m.c **** 
 353:FreeModbus/functions/mbfunccoils_m.c ****         /* Compute the number of expected bytes in the request. */
 354:FreeModbus/functions/mbfunccoils_m.c ****         if( ( usCoilCnt & 0x0007 ) != 0 )
 859              		.loc 1 354 9 is_stmt 1 view .LVU274
 860              		.loc 1 354 11 is_stmt 0 view .LVU275
 861 0030 13F0070F 		tst	r3, #7
 862 0034 09D0     		beq	.L64
 355:FreeModbus/functions/mbfunccoils_m.c ****         {
 356:FreeModbus/functions/mbfunccoils_m.c ****             ucByteCountVerify = ( UCHAR )( usCoilCnt / 8 + 1 );
 863              		.loc 1 356 13 is_stmt 1 view .LVU276
 864              		.loc 1 356 33 is_stmt 0 view .LVU277
 865 0036 C2F3C703 		ubfx	r3, r2, #3, #8
 866              		.loc 1 356 31 view .LVU278
 867 003a 0133     		adds	r3, r3, #1
 868 003c DBB2     		uxtb	r3, r3
 869              	.LVL93:
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 25


 870              	.L65:
 357:FreeModbus/functions/mbfunccoils_m.c ****         }
 358:FreeModbus/functions/mbfunccoils_m.c ****         else
 359:FreeModbus/functions/mbfunccoils_m.c ****         {
 360:FreeModbus/functions/mbfunccoils_m.c ****             ucByteCountVerify = ( UCHAR )( usCoilCnt / 8 );
 361:FreeModbus/functions/mbfunccoils_m.c ****         }
 362:FreeModbus/functions/mbfunccoils_m.c **** 
 363:FreeModbus/functions/mbfunccoils_m.c ****         if( ( usCoilCnt >= 1 ) && ( ucByteCountVerify == ucByteCount ) )
 871              		.loc 1 363 9 is_stmt 1 view .LVU279
 872              		.loc 1 363 11 is_stmt 0 view .LVU280
 873 003e 92B1     		cbz	r2, .L67
 874              		.loc 1 363 32 discriminator 1 view .LVU281
 875 0040 A342     		cmp	r3, r4
 876 0042 05D0     		beq	.L70
 364:FreeModbus/functions/mbfunccoils_m.c ****         {
 365:FreeModbus/functions/mbfunccoils_m.c ****             eRegStatus =
 366:FreeModbus/functions/mbfunccoils_m.c ****                 eMBMasterRegCoilsCB( &ucMBFrame[MB_PDU_REQ_WRITE_MUL_VALUES_OFF],
 367:FreeModbus/functions/mbfunccoils_m.c ****                                usRegAddress, usCoilCnt, MB_REG_WRITE );
 368:FreeModbus/functions/mbfunccoils_m.c **** 
 369:FreeModbus/functions/mbfunccoils_m.c ****             /* If an error occured convert it into a Modbus exception. */
 370:FreeModbus/functions/mbfunccoils_m.c ****             if( eRegStatus != MB_ENOERR )
 371:FreeModbus/functions/mbfunccoils_m.c ****             {
 372:FreeModbus/functions/mbfunccoils_m.c ****                 eStatus = prveMBError2Exception( eRegStatus );
 373:FreeModbus/functions/mbfunccoils_m.c ****             }
 374:FreeModbus/functions/mbfunccoils_m.c ****         }
 375:FreeModbus/functions/mbfunccoils_m.c ****         else
 376:FreeModbus/functions/mbfunccoils_m.c ****         {
 377:FreeModbus/functions/mbfunccoils_m.c ****             eStatus = MB_EX_ILLEGAL_DATA_VALUE;
 877              		.loc 1 377 21 view .LVU282
 878 0044 0320     		movs	r0, #3
 879              	.LVL94:
 880              	.L63:
 378:FreeModbus/functions/mbfunccoils_m.c ****         }
 379:FreeModbus/functions/mbfunccoils_m.c ****     }
 380:FreeModbus/functions/mbfunccoils_m.c ****     else
 381:FreeModbus/functions/mbfunccoils_m.c ****     {
 382:FreeModbus/functions/mbfunccoils_m.c ****         /* Can't be a valid write coil register request because the length
 383:FreeModbus/functions/mbfunccoils_m.c ****          * is incorrect. */
 384:FreeModbus/functions/mbfunccoils_m.c ****         eStatus = MB_EX_ILLEGAL_DATA_VALUE;
 385:FreeModbus/functions/mbfunccoils_m.c ****     }
 386:FreeModbus/functions/mbfunccoils_m.c ****     return eStatus;
 881              		.loc 1 386 5 is_stmt 1 view .LVU283
 387:FreeModbus/functions/mbfunccoils_m.c **** }
 882              		.loc 1 387 1 is_stmt 0 view .LVU284
 883 0046 02B0     		add	sp, sp, #8
 884              	.LCFI26:
 885              		.cfi_remember_state
 886              		.cfi_def_cfa_offset 8
 887              		@ sp needed
 888 0048 10BD     		pop	{r4, pc}
 889              	.LVL95:
 890              	.L64:
 891              	.LCFI27:
 892              		.cfi_restore_state
 360:FreeModbus/functions/mbfunccoils_m.c ****         }
 893              		.loc 1 360 13 is_stmt 1 view .LVU285
 360:FreeModbus/functions/mbfunccoils_m.c ****         }
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 26


 894              		.loc 1 360 31 is_stmt 0 view .LVU286
 895 004a C2F3C703 		ubfx	r3, r2, #3, #8
 896              	.LVL96:
 360:FreeModbus/functions/mbfunccoils_m.c ****         }
 897              		.loc 1 360 31 view .LVU287
 898 004e F6E7     		b	.L65
 899              	.L70:
 365:FreeModbus/functions/mbfunccoils_m.c ****                 eMBMasterRegCoilsCB( &ucMBFrame[MB_PDU_REQ_WRITE_MUL_VALUES_OFF],
 900              		.loc 1 365 13 is_stmt 1 view .LVU288
 366:FreeModbus/functions/mbfunccoils_m.c ****                                usRegAddress, usCoilCnt, MB_REG_WRITE );
 901              		.loc 1 366 17 is_stmt 0 view .LVU289
 902 0050 0123     		movs	r3, #1
 903              	.LVL97:
 366:FreeModbus/functions/mbfunccoils_m.c ****                                usRegAddress, usCoilCnt, MB_REG_WRITE );
 904              		.loc 1 366 17 view .LVU290
 905 0052 0630     		adds	r0, r0, #6
 906 0054 FFF7FEFF 		bl	eMBMasterRegCoilsCB
 907              	.LVL98:
 370:FreeModbus/functions/mbfunccoils_m.c ****             {
 908              		.loc 1 370 13 is_stmt 1 view .LVU291
 370:FreeModbus/functions/mbfunccoils_m.c ****             {
 909              		.loc 1 370 15 is_stmt 0 view .LVU292
 910 0058 0028     		cmp	r0, #0
 911 005a F4D0     		beq	.L63
 372:FreeModbus/functions/mbfunccoils_m.c ****             }
 912              		.loc 1 372 17 is_stmt 1 view .LVU293
 372:FreeModbus/functions/mbfunccoils_m.c ****             }
 913              		.loc 1 372 27 is_stmt 0 view .LVU294
 914 005c FFF7FEFF 		bl	prveMBError2Exception
 915              	.LVL99:
 372:FreeModbus/functions/mbfunccoils_m.c ****             }
 916              		.loc 1 372 27 view .LVU295
 917 0060 F1E7     		b	.L63
 918              	.LVL100:
 919              	.L66:
 384:FreeModbus/functions/mbfunccoils_m.c ****     }
 920              		.loc 1 384 17 view .LVU296
 921 0062 0320     		movs	r0, #3
 922 0064 EFE7     		b	.L63
 923              	.LVL101:
 924              	.L67:
 377:FreeModbus/functions/mbfunccoils_m.c ****         }
 925              		.loc 1 377 21 view .LVU297
 926 0066 0320     		movs	r0, #3
 927 0068 EDE7     		b	.L63
 928              		.cfi_endproc
 929              	.LFE70:
 931              		.text
 932              	.Letext0:
 933              		.file 2 "e:\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\machine\\_default_typ
 934              		.file 3 "e:\\gnu arm embedded toolchain\\10 2021.10\\arm-none-eabi\\include\\sys\\_stdint.h"
 935              		.file 4 "FreeModbus/port/port.h"
 936              		.file 5 "FreeModbus/include/mbport.h"
 937              		.file 6 "FreeModbus/include/mbproto.h"
 938              		.file 7 "FreeModbus/include/mb.h"
 939              		.file 8 "FreeModbus/include/mb_m.h"
ARM GAS  C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s 			page 27


DEFINED SYMBOLS
                            *ABS*:00000000 mbfunccoils_m.c
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:18     .text.eMBMasterReqReadCoils:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:24     .text.eMBMasterReqReadCoils:00000000 eMBMasterReqReadCoils
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:140    .text.eMBMasterFuncReadCoils:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:146    .text.eMBMasterFuncReadCoils:00000000 eMBMasterFuncReadCoils
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:295    .text.eMBMasterReqWriteCoil:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:301    .text.eMBMasterReqWriteCoil:00000000 eMBMasterReqWriteCoil
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:443    .text.eMBMasterFuncWriteCoil:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:449    .text.eMBMasterFuncWriteCoil:00000000 eMBMasterFuncWriteCoil
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:586    .text.eMBMasterReqWriteMultipleCoils:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:592    .text.eMBMasterReqWriteMultipleCoils:00000000 eMBMasterReqWriteMultipleCoils
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:780    .text.eMBMasterFuncWriteMultipleCoils:00000000 $t
C:\Users\BLACK_~1\AppData\Local\Temp\cccWYknz.s:786    .text.eMBMasterFuncWriteMultipleCoils:00000000 eMBMasterFuncWriteMultipleCoils

UNDEFINED SYMBOLS
xMBMasterRunResTake
vMBMasterGetPDUSndBuf
vMBMasterSetDestAddress
vMBMasterSetPDUSndLength
xMBMasterPortEventPost
eMBMasterWaitRequestFinish
xMBMasterRequestIsBroadcast
eMBMasterRegCoilsCB
prveMBError2Exception
